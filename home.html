<!DOCTYPE html>
<html lang = fi>
<head>
<meta charset="UTF-8">
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Crimson+Text&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans+Condensed:500&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:700&display=swap" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>

<style type="text/css">

body {
    /*background: linear-gradient(0deg, rgba(0,0,0,1) 0%, rgba(151,53,36,1) 50%, rgba(0,0,0,1) 100%);*/
    font-family: 'Crimson Text', serif;
}

h1,h2 {
    font-family: 'IBM Plex Sans Condensed', sans-serif;
    font-style: italic;
}

.input {
    background: rgb(223,199,128);
    font-size: 22px;
    font-weight: bold;
    border: 2px solid black;
    width: 16mm;
    height: 16mm;
    text-align: center;
    float: right;
}

.button {
    font-size: 16px;
    font-weight: bold;
    background: #e7aa3c;
    border: 2px solid black;
 }

.button:hover{
    background: rgba(151,53,36,1);
}

.form {
    border: 1.5mm solid black;
    background: #d6d2ce;
    position: relative;
    width: 270mm;
    margin: 3mm 25mm 10mm 0mm;
    padding: 5mm;
    box-sizing: border-box;
}


.upperbar{
    width: 270mm;
    background: #e7aa3c;
    text-align: center;
    position: relative;
    border: 2mm solid black;
    top: 3mm;
    display: table-cell;
    padding-top: 4mm;
    box-sizing: border-box;
}

.boxtitle{
    background: #e7aa3c;
    position: relative;
    border: 1.5mm solid black;
    top: -6mm;
    width: 200mm;
    right: 6mm;
    display: table-cell;
    vertical-align: middle;
    padding-left: 5mm;
}

.card {
    margin-bottom: 1mm;
    margin-top: 1mm;
    margin-left: 1mm;
    float: left;
    position: relative;
}

.titletext {
    color: white;
    font-family: 'Yanone Kaffeesatz', sans-serif;
    bottom: 0;
    position: relative;
    box-sizing: border-box;
    height: 10mm;
    padding-top: 3mm;
    padding-bottom: 1mm;
    display: table-cell;
    font-size: 24px;
    border: 2pt solid transparent;
}

.story {
    border: 1.5mm solid black;
    background: #d6d2ce;
    width: 50%;
    float: right;
}

.storycardfront {
    width: 63mm;
    box-sizing: border-box;
    font-family: 'IBM Plex Sans', sans-serif;
    float: left;
    margin-right: 0.2mm;
}

.storycard-divider {
    height: 0.8mm;
    background: linear-gradient(90deg, rgba(130,130,130,1) 0%, rgba(255,255,255,1) 37%, rgba(255,255,255,1) 53%, rgba(130,130,130,1) 100%);
}

.storycardfront-title{
    background: linear-gradient(90deg, rgba(78,74,62,1) 0%, rgba(59,56,46,1) 10%, rgba(3,2,2,1) 100%);
    border-top-right-radius: 12px;
    border-top-left-radius: 12px;
    height: 10mm;
}
.storycardfront-subtitle{
    height: 3mm;
    background: black;
    font-style: italic;
    font-size: 7px;
    color: #d6d2ce;
    box-sizing: border-box;
    padding-left: 17mm;
    padding-top: 0.5mm;
    padding-right: 2mm;
}
.storycardfront-prologue{
    height: 57.6mm;
    background: linear-gradient(0deg, rgba(140,130,124,1) 0%, rgba(222,205,195,1) 3%, rgba(222,205,195,1) 97%, rgba(140,130,124,1) 100%);
    box-sizing: border-box;
    
}

.storycardfront-prologuetext{
    padding: 3mm;
    color: black;
    font-family: 'IBM Plex Sans', sans-serif;
    font-style: italic;
    font-size: 8px;
}

.storycardfront-setup{
    background: linear-gradient(90deg, rgba(78,74,62,1) 0%, rgba(59,56,46,1) 10%, rgba(3,2,2,1) 100%);
    border-bottom-right-radius: 12px;
    border-bottom-left-radius: 12px;
    font-family: 'IBM Plex Sans Condensed', sans-serif;
    height: 16mm; 
    color: #d6d2ce;
    box-sizing: border-box;
    padding-left: 2mm;
    padding-top: 1.5mm;
    padding-bottom: 2mm;
    padding-right: 2mm;
    font-weight: 100;
    position: relative;
}

.setuptext{
    font-size: 8px;
    position: relative;
}

.storycardback {
    width: 63mm;
    box-sizing: border-box;
    font-family: 'IBM Plex Sans', sans-serif;
    float: left;
}

.storycardback-bar-top{
    background: linear-gradient(90deg, rgba(78,74,62,1) 0%, rgba(59,56,46,1) 10%, rgba(3,2,2,1) 100%);
    border-top-right-radius: 12px;
    border-top-left-radius: 12px;
    height: 3mm;
}

.storycardback-epilogue-top{
    height: 36.6mm;
    background: linear-gradient(0deg, rgba(140,130,124,1) 0%, rgba(222,205,195,1) 3%, rgba(222,205,195,1) 97%, rgba(140,130,124,1) 100%);
    color: black;
    font-family: 'IBM Plex Sans', sans-serif;
    font-style: italic;
    box-sizing: border-box;
}

.storycardback-titlebar{
    width: 63mm;
    height: 6mm;
    -webkit-clip-path: polygon(0 0, 100% 0%, 100% 32%, 80.5% 32%, 75.5% 100%, 24.5% 100%, 19.5% 32%, 0% 32%);
    background: linear-gradient(90deg, rgba(130,130,130,1) 0%, rgba(255,255,255,1) 37%, rgba(255,255,255,1) 53%, rgba(130,130,130,1) 100%);
    position: relative;
    z-index: 2;
}

.storycardback-epiloguetitle {
    width: 63mm;
    height: 5mm;
    position: relative;
    font-family: 'IBM Plex Sans Condensed', sans-serif;
    font-size: 9px;
    background: #30271B;
    top: 0.4mm;
    font-style: italic;
    padding-top: 1mm;
    padding-left: 23mm;
    color: #d6d2ce;
    box-sizing: border-box;
    -webkit-clip-path: polygon(0 0, 100% 0%, 100% 20%, 80% 20%, 75% 100%, 25% 100%, 20% 20%, 0% 20%);
    z-index: 2;
}

.storycardback-winepiloguetext,
.storycardback-loseepiloguetext {
    box-sizing: border-box;
    padding: 0.5mm 3mm 3mm 3mm;
    color: black;
    font-family: 'IBM Plex Sans', sans-serif;
    font-style: italic;
    position: relative;
    bottom: 5mm;
    font-size: 8px;
}

.storycardback-colorbar-back {
    display: inline-block;
    float: none;
    width: 60.5mm;
    height: 1.5mm;
    background: linear-gradient(90deg, rgba(130,130,130,1) 0%, rgba(255,255,255,1) 37%, rgba(255,255,255,1) 53%, rgba(130,130,130,1) 100%);
    position: relative;
    left: 1mm;
    bottom: 7mm;
    -webkit-clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%);
    z-index: 1;
}

.storycardback-colorbar-red,
.storycardback-colorbar-green {
    float: none;
    width: 58mm;
    height: 1mm;
    position: relative;
    left: 1.5mm;
    -webkit-clip-path: polygon(0 0, 100% 0, 96% 100%, 4% 100%);
    z-index: 1;

}

.storycardback-colorbar-red {
     background: #c4331a;
}

.storycardback-colorbar-green {
    background: #0a612b;
}

.storycardback-epilogue-bottom{
    height: 45.4mm;
    background: linear-gradient(0deg, rgba(140,130,124,1) 0%, rgba(222,205,195,1) 3%, rgba(222,205,195,1) 97%, rgba(140,130,124,1) 100%);
    color: black;
    font-family: 'IBM Plex Sans', sans-serif;
    box-sizing: border-box;
}

.storycardback-bar-bottom{
    background: linear-gradient(90deg, rgba(78,74,62,1) 0%, rgba(59,56,46,1) 10%, rgba(3,2,2,1) 100%);
    border-bottom-right-radius: 12px;
    border-bottom-left-radius: 12px;
    height: 3mm; 
    color: #d6d2ce;
    font-size: 9px;
    font-weight: 100;
    position: relative;
}

.storycardback-bottomtitle{
    background: #fffcf0;
    height: 6mm;
    width: 29mm;
    position: relative;
    left: 17mm;
    bottom: 3mm;
    box-sizing: border-box;
    color: black;
    font-style: italic;
    font-weight: bold;
    font-family: 'IBM Plex Sans Condensed', sans-serif;
    padding-top: 1mm;
    text-align: center;
    font-size: 7px;
    -webkit-clip-path: polygon(20.5% 0%, 79.5% 0%, 100% 100%, 0% 100%);
    z-index: 1;
}

.circle-outer,
.circle-middle,
.circle-inner {
    display: inline-block;
    border-radius: 50%;
    float: none;
}

.circle-outer {
    height: 13mm;
    width: 13mm;
    background: linear-gradient(180deg, rgba(221,221,221,1) 0%, rgba(51,51,51,1) 100%);
    margin-top: 3mm;
    margin-left: 2.2mm;
}

.circle-middle {
    height: 10.5mm;
    width: 10.5mm;
    background: linear-gradient(0deg, rgba(255,255,255,1) 0%, rgba(0,0,0,1) 100%);
    margin-top: 1.25mm;
    margin-left: 1.25mm;
}

.circle-inner {
    height: 10mm;
    width: 10mm;
    background: black;
    margin-top: 0.25mm;
    margin-left: 0.25mm;
}

.expansionicon{
    position: absolute;
    float: right;
    bottom:2mm;
    right: 2mm;
    width: 4mm;
    height: 2mm;
}

.infinity{
    margin-left: 50mm;
    float: right;
}

.infinity-before,
.infinity-after {
    position: absolute;
    box-sizing: border-box;
    width: 2mm;
    height: 2mm;
    border: 0.5mm solid white;
    border-radius: 50px 50px 0px 50px;
    transform: rotate(-45deg);
}
.infinity-after {
    border-radius: 50px 50px 50px 0;
    transform: rotate(45deg);
    margin-left: 2mm;
}

.backbar {
    height: 300mm;
    width: 400mm;
    /*width: 270mm;*/
    background: white;
    /*background: #f7edd9;*/
    position: relative;
    right: 4mm;
    bottom: 4mm;
}
</style>
</head>

<body>
<div class=upperbar style = "display: none;">
<h1>Street Masters - Endless Story Mode</h1>
</div>

<div class=form style = "display: none">
<form>
  <div class = "boxtitle"><span><h2>Number of Global Gladiators?</b></h2></span><input type="text" class="input" id="players" name="players" size="18", value = "0"/></div><br>
  <input type="button" class="button" value="The Kingdom must fall!" onclick="createStory()">
  <div id = "ourheroes"></div>
</form>
</div>

<div class=backbar>
<div class = "card" id = "card1"></div>
<div class = "card" id = "card2"></div>
<div class = "card" id = "card3"></div>
<div class = "card" id = "card4"></div>
<div class = "card" id = "card5"></div>
<div class = "card" id = "card6"></div>
<div class = "card" id = "card7"></div>
<div class = "card" id = "card8"></div>
<div class = "card" id = "card9"></div>
</div>
</div>
<script type="text/javascript">

let enemiescopy = []

$(document).on('keypress',function(e) {
    if(e.which == 13) {
        createStory();
    }
});

$(document).on("click", function(event) {createStory()})
    
$( document ).ready(function() {
    
    let cardnumber = 1;
    $(".card").each(function() {
        cardnumber++;
    $(this).html(`<div class = "card" id = "card${cardnumber}">
    
<div class = "storycardfront">
<div class = "storycardfront-title" id="storycardfront-title${cardnumber}">
    <div class = "circleicon" style="float: left">
        <span class="circle-outer"><span class="circle-middle"><span class="circle-inner"></span></span></span>
    </div>
    <div class="titletext"></div>
</div>
<div class = "storycard-divider"></div>
<div class = "storycardfront-subtitle" id="storycardfront-subtitle${cardnumber}"></div>
<div class = "storycard-divider"></div>
<div class = "storycardfront-prologue"><div class = "storycardfront-prologuetext"></div></div>
<div class = "storycard-divider"></div>
<div class = "storycardfront-setup">
    <div class = "setuptext" id = "setuptext${cardnumber}"></div>
    <div class = "expansionicon">
        <span class="infinity-before"></span><span class="infinity-after"></span>
    </div>
</div>
</div>

<div class = "storycardback">
<div class = "storycardback-bar-top"></div>
<div class = "storycard-divider" style = "height: 0.4px"></div>
<div class = "storycardback-epilogue-top" id = "storycardback-epilogue-top${cardnumber}">
    <div class = "storycardback-titlebar">
    <div class = "storycardback-epiloguetitle">If the fighers win:</div>
    </div>
        <div class = "storycardback-colorbar-back"><div class = "storycardback-colorbar-green"></div></div>
        <div class = "storycardback-winepiloguetext"></div>

</div>
<div class = "storycardback-epilogue-bottom" id = "storycardback-epilogue-bottom${cardnumber}">
<div class = "storycardback-titlebar">
    <div class = "storycardback-epiloguetitle">If the fighters lose:</div>
    </div>
        <div class = "storycardback-colorbar-back"><div class = "storycardback-colorbar-red"></div></div>
        <div class = "storycardback-loseepiloguetext"></div>
</div>
<div class = "storycard-divider"></div>
<div class = "storycardback-bar-bottom">
        <div class = "storycardback-bottomtitle" id = "storycardback-bottomtitle${cardnumber}"></div>
</div>
</div>

</div>`);
  });
    
});

function randFrom(array) {
    return array[Math.floor(Math.random()*array.length)]
}

function globalGladiators() {
    // {name: "", enemy: "", ally: "", rival: ""; stage: ""}
    
    let gladiators = [
        {name: "Ah Long", enemy: ["Ah Long"/*, "The Kingdom"*/], ally: ["Wan Bo"], rival: ["Shadow", "Jackal", "Wan Bo"], stage: ["Steel Memories"]},
        {name: "Axel", enemy: "Mack", ally: ["Mary Ann"], rival: ["Mary Ann"], stage: ["Under Destruction"]},
        {name: "Brandon", enemy: "Ah Long", ally: ["Isabella"], rival: ["Isabella"], stage: ["Cashed Out", "Steel Memories"]},
        {name: "Clint", enemy: "", ally: [""], rival: [""], stage: [""]},
        {name: "Dmitri", enemy: "", ally: [""], rival: ["Anastasia"], stage: ["Right to Remain Silent"]},
        {name: "Gabriel", enemy: "Jackal", ally: ["Drago"], rival: ["Drago"], stage: ["Original Copy"]},
        {name: "Jackal", enemy: "Shadow", ally: ["Project X"], rival: ["Kemono", "Project X"], stage: ["Steel Memories"]},
        {name: "Juan", enemy: ""/*"The Kingdom"*/, ally: ["Tiger Azules"], rival: ["Tiger Azules"], stage: ["Compromised"]},
        {name: "Kemono", enemy: "", ally: ["Darius"], rival: ["Shadow", "Darius"], stage: ["Sudden Death"]},
        {name: "Kyoryu", enemy: ""/*"Any Enemy"*/, ally: ["Hanzo"], rival: ["Hanzo"], stage: ["Sudden Death"]},
        {name: "Max", enemy: "", ally: [""], rival: [""], stage: ""},
        {name: "Megan", enemy: ["The Brotherhood"/*, "Any Enemy"*/], ally: ["Sera O'Quinn"], rival: ["Sera O'Quinn"], stage: ["Gone Ballistic", "Compromised"]},
        {name: "Natalia", enemy: "The Brotherhood", ally: ["Zane"], rival: ["Zane"], stage: ["Gone Ballistic", "Original Copy"]},
        {name: "Rhys", enemy: "The Onyx League", ally: ["Leeta"], rival: ["Leeta"], stage: ["Poison the Well"]},
        {name: "Shadow", enemy: "The Cartel", ally: ["Shin Yokai"], rival: ["Ah Long", "Dmitri", "Shin Yokai", "Kemono"], stage: [""]/*"Any Stage"*/},
        {name: "Tiger Azules", enemy: "", ally: [""], rival: [""], stage: ""},
        {name: "Ying Hua", enemy: "The Golden Dragons", ally: ["Jin"], rival: ["Jin"], stage: ["Cashed Out"]}
        ]        
        
    let globalgladiators = []


    while (globalgladiators.length < $("#players").val()) {
        let random = Math.floor(Math.random()*gladiators.length)
        let newgladiator = gladiators[random]
        globalgladiators.push(newgladiator)
        gladiators.splice(random,1)
    } 

    let ourheroes = "This story is best experienced with "
    for (i = 0; i < globalgladiators.length; i++) {
        ourheroes = ourheroes + "<b>" + globalgladiators[i].name + "</b>" + (i == globalgladiators.length-2 ? " and " : ", ")
    }

    globalgladiators.length > 0 ? document.getElementById("ourheroes").innerHTML = ourheroes.substring(0, ourheroes.length - 2) + "." : ``

    return globalgladiators;
}

function createStory() {
    
    let globalgladiators = globalGladiators()
    
    let herostages = []
    let supportingcast = []
    let heronames = []

    $(globalgladiators).each(function () {
        herostages = _.union(herostages, this.stage)
        supportingcast = _.union(supportingcast, this.ally)
        supportingcast = _.union(supportingcast, this.rival)
        heronames.push(this.name)
        })
        
    herostages = (_.uniq(herostages)).filter(function(el) { return el; });
    supportingcast = (_.uniq(supportingcast)).filter(function(el) { return el; });
        
let alliesandrivals = [
        {name: "Ah Long"},
        {name: "Ah Long of Brook City"},
        {name: "Anastasia"},
        {name: "Chan Chan"},
        {name: "Clinhylde Eight"},
        {name: "Darius"},
        {name: "Dmitri"},
        {name: "Drago"},
        {name: "Hanzo"},
        {name: "Isabella"},
        {name: "Jackal"},
        {name: "James Wong"},
        {name: "Jin"},
        {name: "Juan"},
        {name: "Kemono"},
        {name: "Khadath Ahemusei"},
        {name: "Leeta"},
        {name: "Lotus"},
        {name: "Mary Ann"},
        {name: "Mr. Apple"},
        {name: "Project X"},
        {name: "Sera O'Quinn"},
        {name: "Shadow"},
        {name: "Shin Yokai"},
        {name: "Star Knight Iri"},
        {name: "Tiger Azules"},
        {name: "Wan Bo"},
        {name: "Ying Hua of Brook City"},
        {name: "Zane"}
        ];

for (i = alliesandrivals.length-1; i > 0; i--) {
    if (supportingcast.includes(alliesandrivals[i].name)) {
        alliesandrivals.splice([i],1)
    
    }
    }

    let stages = [
    {name:"Ashes of the Eternal", instory: 0},
    {name:"Cashed Out", instory: 0},
    {name:"Compromised", instory: 0},
    {name:"Gone Ballistic", instory: 0},
    {name:"One Step Ahead", instory: 0},
    {name:"Original Copy", instory: 0},
    {name:"Out of Time", instory: 0},
    {name:"Poison the Well", instory: 0},
    {name:"Right to Remain Silent", instory: 0},
    {name:"Rude Awakening", instory: 0},
    {name:"Running Wild", instory: 0},
    {name:"Steel Memories", instory: 0},
    {name:"Sudden Death", instory: 0},
    {name:"Supply & Demand", instory: 0},
    {name:"The Ceremony", instory: 0},
    {name:"Under Destruction", instory: 0}
    ];
    
    
    for (i = 0; i < stages.length; i++) {
        for (y = 0; y < herostages.length; y++) {
            if (herostages[y] === stages[i].name) {
                stages[i].instory = stages[i].instory +1
            }
        }
    }

    stages = cleanStages(stages);

let enemies = [
    {name:"Brotherhood", boss: "Dmitri", bosstitle: "callous mercenary", sex: "male", desc: "the ruthless band of mercenaries", addressing: "comrades", minions: "mercenaries, soldiers and spies", threat: "unsheaths his knife, running it along his fingers", minionnames: ["Anastasia", "Boris", "Drago"]},
    {name:"Cartel", boss: "Juan", bosstitle: "ruthless gangster", sex: "male", desc: "the gang of vicious drug smugglers", addressing: "my boys", minions: "vicious gangers and hardened outcasts", threat: "levels his gun straight at you", minionnames: ["Tyrone", "Ignacio", "Lucille"]},
    {name:"Golden Dragons", boss: "Ah Long", bosstitle: "unrelenting martial arts master", sex: "male", desc: "the enterprise of martial artists, thugs, and businessmen", addressing: "weasels", minions: "ruthless triads and yakuza", threat: "lifts his hand, chi energy flaring on his fist", minionnames: ["Jin", "Dao", "Wan Bo"]},
    {name:"Kingdom", boss: "Kemono", bosstitle: "imposing green mutant", sex: "male", desc: "the mysterious criminal syndicate", addressing: "whelps", minions: "mysterious ninja and martial arts masters", threat: "lifts his mighty fist, lightning crackling", minionnames: ["Power Soldier", "Marionette Doll", "Mountain General"]},
    {name:"Kingdom", boss: "Jackal", bosstitle: "mad scientist", sex: "female", desc: "the mysterious criminal syndicate", addressing: "my subjects", minions: "mysterious ninja and clone puppets", threat: "lifts up an unnerving syringe", minionnames: ["Power Soldier", "Marionette Doll", "Mountain General"]},
    {name:"Kingdom", boss: "Shadow", bosstitle: "ominous mastermind", sex: "male", desc: "the mysterious criminal syndicate", addressing: "you fools", minions: "mysterious ninja and martial arts masters", threat: "lifts his hand, a dark blade materializing out of thin air", minionnames: ["Power Soldier", "Marionette Doll", "Mountain General"]},
    {name:"Nahualli", boss: "Tlazolteotl", bosstitle: "Aztec empress", sex: "female", desc: "the ancient, restless warriors", addressing: "warriors", minions: "necromancers and walking dead", threat: "reaches for you, fingers spread wide, purple arcane energy crackling between them", minionnames: ["Pale Caller","Pale Caller"]},
    {name:"Oni", boss: "Yokai", bosstitle: "cursed, powerful warrior", sex: "male", desc: "the group of cursed spirits", addressing: "you fools", minions: "ancient guardians and powerful spirits", threat: "lifts his mighty fist, eldritch power crackling", minionnames: ["Yurei Ninja", "Kitsune"]},
    {name:"Onyx League", boss: "Mack", bosstitle: "black-hearted overlord", sex: "male", desc: "the league of street gangs", addressing: "pigs", minions: "vicious gangers and street criminals", threat: "levels his gun straight at you", minionnames: ["Abolo", "Felicia Salt", "Veronica Pepper"]}
    ];

enemiescopy = enemies.slice(0,enemies.length)

let storystages = storyStages(stages);

stages = storystages[1].splice(0)

storystages = storystages[0].splice(0)

let storyenemies = storyEnemies(storystages, enemies);

enemies = storyenemies[1].splice(0)

storyenemies = storyenemies[0].splice(0)

let story = compileStory(storystages, storyenemies)

let finalboss = story[7].enemy

let stageindex = 0;

let storyname = String(storyNamer(finalboss,story[7].stage))

$(".titletext").each(function() {
    $(this).text(storyname);
})

$(function() {
    $(".titletext").each(function(i) {
        $(this).css({"bottom": "0px", "font-size": "21px"})
        var element = $(this)
                        .clone()
                        .css({display: 'inline', visibility: 'hidden'})
                        .appendTo('body');
        if (element.width() > ($(this).width()+1)) {$(this).css({"bottom": "+=13px", "font-size": "+-2px"})}
        //((element.width() > ($(this).width()+1)) ? $(this).css({fontSize: "19px", "bottom": "35%"}) : $(this).css({fontSize: "21px", "bottom": "0px"}))
    
        element.remove();
    });
});



stageindex = 0
$(".storycardfront-subtitle").each(function() {
    $(this).html((finalboss.name).toUpperCase() + ` STORY <span style="float:right">PART ${story[stageindex].chapter} PROLOGUE</span>`);
    stageindex++
})

let cardtexts = textMaker(story, alliesandrivals, heronames, enemies);

$(`.storycardfront-prologuetext`).each(function(index) {
    $(this).html(cardtexts[index].prologue);
})

$(function() {
    $(`.storycardfront-prologuetext`).each(function(i) {
        $(this).css({"font-size": "8px"})
        if ($(this).height() > 198) {$(this).css({"font-size": "7px"})}
    });
});

$(`.setuptext`).each(function(index) {
    $(this).html(cardtexts[index].setup);

})

$(function() {
    $(".setuptext").each(function(i) {
        $(this).css({"bottom": "0px", "font-size": "8px"})
        if (($(this).height() > 51)) {$(this).css({"font-size": "+-2px", "bottom": "+=7px"})}
    });
});


$(`.storycardback-winepiloguetext`).each(function(index) {
    $(this).html(cardtexts[index].winepilogue);

})


$(`.storycardback-loseepiloguetext`).each(function(index) {
    $(this).html(cardtexts[index].loseepilogue);
})

stageindex = 0
$(".storycardback-bottomtitle").each(function() {
    $(this).text("PART " + story[stageindex].chapter + " EPILOGUE");
    stageindex++
})
    
}

function defineAddressing(enemy) {

let addressing = randFrom([enemy.addressing,"Global Gladiators","Gladiators"])

    return addressing
}

function genderPronoun(bossname, form) {
let genderpronoun

switch(bossname) {
    case "male":
        switch(form) {
            case "subject": genderpronoun = "he";
            break;
            case "object": genderpronoun = "him";
            break;
            case "possessive": genderpronoun = "his";
            break;
            case "reflexive": genderpronoun = "himself";
            break;
            default: genderpronoun = "UNDEFINED"
        }
    break;
    case "female":
        switch(form) {
            case "subject": genderpronoun = "she";
            break;
            case "object": 
            case "possessive": genderpronoun = "her";
            break;
            case "reflexive": genderpronoun = "herself";
            break;
            default: genderpronoun = "UNDEFINED";
        }
    break;
    default: 
        genderpronoun= "UNDEFINED"
    
}
    return genderpronoun

}

function upperCaseInitial (word) {
    let result = word.charAt(0).toUpperCase() + word.substring(1);
    return result
}

function lowerCaseInitial (word) {
    let result = word.charAt(0).toLowerCase() + word.substring(1);
    return result
}

function whichPreposition (word) {
    if (/[aeiou]/.test(word.charAt(0)) == true) {
        return "an"
    } else {
    return "a"}
}

function latestScheme() {
    let latestscheme = [
        `In Citadel's ongoing investigations, rumors have been uncovered that`,
        `In the wake of the Kingdom's latest scheme, the Citadel has learned a new threat on the rise: `,
        `Following the aftermath of the Kingdom's latest scheme,`,
        `The Citadel has learned the nefarious motives behind the latest criminal activities: `,
        `In a situation familiar to the Citadel and Global Gladiators, `,
        `In a street-level recon operation, Citadel has uncovered a job fit for Global Gladiators: `,
        `Thanks to Citadel's resourcefulness and your familiarity with the Kingdom's street-level activity, there's new intel that`, 
        ];
    latestscheme = randFrom(latestscheme);
    return latestscheme
}

function preGamePrologue(stage, enemy) {
    
    let latestscheme = latestScheme()
    
    let masterplan
    
    let actsofterror = ["actsofterror",`the vicious criminal syndicate ${enemy.name} believes they do not have to bow to the city government or even the
    police force. ${enemy.boss} is going to let everyone know that the city has become a center of violence and crime where no-one is safe. `];
    
    let illegalgains = ["illegalgains",`the ${enemy.name}${possessiveSuffix(enemy.name)} vast network of crime and 
        ${(enemy.desc).replace("the","")} require substantial financial pipelines, and ${enemy.boss} is organizing a big score to fund
        ${genderPronoun(enemy.sex, "possessive")} operations. `];
    
    let vip = [["President", "White House"], ["Colonel", "Pentagon"], ["Mayor", "city hall"], ["Police Chief", "police station"], ["Citadel commander", "Citadel HQ"]]
    vip = randFrom(vip)
    
    let kidnapping = ["kidnapping", `the ${vip[1]} is not the exception to the rampant crimes related to the Kingdom these days. The ${vip[0]} has been kidnapped by the
    ${enemy.minions} of ${enemy.boss}. Are you a bad enough dude to rescue the ${vip[0]}? `];

    let strengtheningforces = ["strengtheningforces",`the ${enemy.bosstitle} ${enemy.boss} has been covertly making efforts to
            strengthen the forces of the ${enemy.name}. Their plans must be thwarted before their forces become unstoppable.`]
    
    let personalpower = ["personalpower",`the ${enemy.bosstitle} ${enemy.boss} has moved across the region with ${genderPronoun(enemy.sex, "possessive")}
        ${enemy.minions} in search for power. If ${genderPronoun(enemy.sex, "possessive")} power levels will near five figures, ${genderPronoun(enemy.sex, "subject")}
        just might become invincible. `];

    switch(stage.name){
        
    case "Ashes of the Eternal": masterplan = (Math.random() < 0.5 ? actsofterror : personalpower)
    break;
    case "Cashed Out": masterplan = (Math.random() < 0.5 ? illegalgains : actsofterror)
    break;
    case "Compromised": masterplan = (Math.random() < 0.5 ? actsofterror : kidnapping)
    break;
    case "Gone Ballistic": masterplan = (Math.random() < 0.5 ? illegalgains : strengtheningforces)
    break;
    case "One Step Ahead": masterplan = (Math.random() < 0.5 ? personalpower : kidnapping)
    break;
    case "Original Copy": masterplan = (Math.random() < 0.5 ? strengtheningforces : personalpower)
    break;
    case "Out of Time": masterplan = (Math.random() < 0.5 ? strengtheningforces : personalpower)
    break;
    case "Poison the Well": masterplan = (Math.random() < 0.5 ? actsofterror : strengtheningforces)
    break;
    case "Right to Remain Silent": masterplan = (Math.random() < 0.5 ? illegalgains : kidnapping)
    break;
    case "Rude Awakening": masterplan = (Math.random() < 0.5 ? actsofterror : strengtheningforces)
    break;
    case "Running Wild": masterplan = (Math.random() < 0.5 ? personalpower : illegalgains)
    break;
    case "Steel Memories": masterplan = (Math.random() < 0.5 ? actsofterror : kidnapping)
    break;
    case "Sudden Death": masterplan = (Math.random() < 0.5 ? kidnapping : strengtheningforces)
    break;
    case "Supply & Demand": masterplan = (Math.random() < 0.5 ? illegalgains : actsofterror)
    break;
    case "The Ceremony": masterplan = (Math.random() < 0.5 ? kidnapping : personalpower)
    break;
    case "Under Destruction": masterplan = (Math.random() < 0.5 ? actsofterror : illegalgains)
    break;
    
}

    masterplan[1] = latestscheme + " " + masterplan[1]
    
    return masterplan
}

function mysticalSynonym(){
    
    
    let mystical = ["esoteric", "magical", "arcane", "ethereal", "mystical", "cabalistic", "mysterious", "occult", "obscure", "cryptic", "fabulous secret"];
    mystical = mystical[Math.floor(Math.random()*mystical.length)];
    
    return mystical;
    
}

function cleanStages(stages) {

    for (i = 0; i < stages.length; i++) {
        if (stages[i].instory >= 2) {
            stages.splice(i, 1);
            i = i - 1;
        }
    }

    return stages
}

function storyNamer(finalboss,finalstage, number = 16){
    
    let bossadjectives
    let bossnouns
    let stageadjectives
    let stagenouns
    let adjectives = ["Avenging","Deadly","Final","Mortal","Double","Twin","Fighting","Bad","Mysterious","Lost","Unleashed","New","Eternal","Forever","Ultimate","Evil"];
    let nouns = [["Revenge","Revenge"],["Fate","Fates"],["Destiny","Destiny"],["Redemption","Redemption"],["Aftershock","Aftershock"],["Warrior","Warriors"],["Combat","Kombat"],["Fighter","Fighters"],["Force","Forces"],["Thug","Thugs"],["Rage","Rage"],["City","City"],["Ransom","Ransom"],["Fight","Fights"],["Kingdom","Kingdoms"],["Street","Streets"],["Master","Masters"],["Rise","Rise"],["Legend","Legends"]];
    
    switch (finalboss.boss) {
        case "Ah Long":
            bossadjectives = ["Heavenly","Phasing","Golden","Black","Merciless","Invincible"]
            bossnouns = [["Dragon","Dragons"],["Businessman","Businessmen"],["Hook","Hooks"],["Karate","Karate"],["Kendo","Kendo"],["Jing Wu","Jing Wu"],["Punch","Punches"],["Triad","Triads"],["Yakuza","Yakuza"],["Monk","Monks"],["Typhoon","Typhoons"],["Kick","Kicks"],["Shadowson","Shadowsons"],["Clutch","Clutces"],["Katana","Katana"],["Staff","Staves"],["Knuckle-Duster","Knuckle-Dusters"]]
        break;
        case "Dmitri":
            bossadjectives = ["Punishing","Modified","Trusty","Steely","Loaded","Extra","Russian","Eastern","Military","Angry","Strong","Skilled","Loyal","Espionage","Undercover"]
            bossnouns = [["Brotherhood","Brotherhood"],["Knife","Knives"],["Rocket Launcher","Rocket Launchers"],["Kevlar","Kevlar"],["Defense","Defenses"],["Hold","Holds"],["Ammo","Ammo"],["Mercenary","Mercenaries"],["Soldier","Soldiers"],["Spy","Spies"],["Honor","Honor"],["Hit","Hits"],["Sabotage","Sabotage"],["General","Generals"]]
        break;
        case "Jackal":
            bossadjectives = ["Broken","Neural","Dark","Wild","Mad","Insane","Genius","Torturous","Unbelievable","Scientific","Experimental"]
            bossnouns = [["Kingdom","Kingdom"],["Scientist","Scientists"],["Jackal","Jackals"],["Experiment","Experiments"],["Matter","Matters"],["Sister","Sisters"],["Flesh","Flesh"],["Lances","Lances"],["Invasion","Invasion"],["Mold","Molds"],["Ninja","Ninja"],["Clone","Clones"],["General","Generals"],["Mountain","Mountains"],["Marionette","Marionettes"],["Soldier","Soldiers"],["Doll","Dolls"]]
        break;
        case "Juan":
            bossadjectives = ["Unloading","Getaway","Alert","Hard","Honorable","Ruthless","Avenging","One","Loyal","Devoted"]
            bossnouns = [["Getaway","Getaway"],["Revenge","Revenge"],["Cartel","Cartel"],["Flintlock","Flintlocks"],["Code","Code"],["Orphan","Orphans"],["Outcast","Outcasts"],["Gun","Guns"],["Gangster","Gangsters"],["Extortion","Extortion"],["Honor","Honor"],["Protection","Protection"],["Carbine","Carbines"],["Human Shield","Human Shields"],["Double Barrels","Double Barrels"],["Family","Families"],["Drug","Drugs"],["Gang","Gangs"],["Bat","Bats"],["Dealer","Dealers"],["Ganger","Gangers"]]
        break;
        case "Kemono": 
            bossadjectives = ["Apocalypse","Imposing","Green","Enraged","Hulking","Loyal","Uncontrollable","Crackling","Static","Quadruple","Electrical","Savage","Mountain"]
            bossnouns = [["Hulk","Hulk"],["Kingdom","Kingdom"],["Mutant","Mutants"],["Horseman","Horsemen"],["Beast","Beasts"],["Surge","Surges"],["Lash","Lashes"],["Grab","Grabs"],["Arms","Arms"],["Prowess","Prowess"],["Current","Currents"],["Brute","Brutes"],["Ninja","Ninja"],["Clone","Clones"],["General","Generals"],["Mountain","Mountains"],["Marionette","Marionettes"],["Soldier","Soldiers"],["Doll","Dolls"]]
        break;
        case "Mack": 
            bossadjectives = ["Hot", "Suppressing","Black-Hearted","Aimed","Ruthless","Reckless","Whipped","Anarchic"]
            bossnouns = [["Trigger","Triggers"],["Lead","Lead"],["Fire","Fire"],["Crosshair","Crosshairs"],["Salt","Salt"],["Pepper","Pepper"],["Blackheart","Blackheart"],["Mercy","Mercy"],["Overlord","Overlords"],["Protection","Protection"],["Gang","Gangs"],["Machine Gun","Machine Guns"],["Bullet","Bullets"]]
        break;
        case "Shadow": 
            bossadjectives = ["Hexed","Prescient","Mysterious","Ancient","Divine","Explosive","Hidden"]
            bossnouns = [["Kingdom","Kingdom"],["Blade","Blades"],["Jing Wu","Jing Wu"],["Dragon","Dragons"],["Illusion","Illusions"],["Sword","Swords"],["Shadow","Shadows"],["Spirit","Spirits"],["Clone","Clones"],["General","Generals"],["Mountain","Mountains"],["Marionette","Marionettes"],["Soldier","Soldiers"],["Doll","Dolls"]]
        break;
        case "Tlazolteotl":
            bossadjectives = ["Faithful","Aztec","Summoned","Otherworldly","Death","Pale","Avenging","Foul","Decaying","Enfeebling","Ageless","Beautiful","Restless","Pestilent","Below"]
            bossnouns = [["Time","Time"],["Undead","Undead"],["Faithful","Faithful"],["Sorcery","Sorceries"],["Portal","Portals"],["Pestilence","Pestilence"],["Dead","Dead"],["Nahualli","Nahualli"],["Faithful","Faithful"],["Necromancer","Necromancers"],["Zombie","Zombies"],["Caller","Callers"],["Essence","Essences"],["Prophecy","Prophecies"],["Blast","Blasts"],["Flesh","Flesh"],["Hex","Hexes"],["Burden","Burdens"]]
        break;
        case "Yokai":
            bossadjectives = ["Cursed","Deceptive","Eldritch","Raging","Unleashed","Dynasty","Enraged","Nine-Tailed"]
            bossnouns = [["47","47"],["Hellfire","Hellfire"],["Sorrow","Sorrows"],["Monster","Monsters"],["Oni","Oni"],["Demon","Demons"],["Yurei","Yurei"],["Ninja","Ninja"],["Shadow","Shadows"],["Strike","Strikes"],["Swarm","Swarms"],["Fox","Foxes"],["Rage","Rage"],["Aura","Auras"],["Oblivion","Oblivion"],["Shackle","Shackles"],["Fear","Fear"],["Devil","Devil"],]
        break;
        default:
            bossadjectives = adjectives
            bossnouns = nouns
    }
    
    switch (finalstage.name) {
        case "Ashes of the Eternal":
            stageadjectives = ["Unholy","Unclean","Rising","Blazing","Burnt"]
            stagenouns = [["Eternal","Eternals"],["Ash","Ashes"],["Inferno","Inferno"],["Urn","Urns"],["Demon","Demons"],["Apparition","Apparitions"],["Path","Paths"],["Flame","Flames"],["Fire","Fires"]]
        break;
        case "Cashed Out":
            stageadjectives = ["Winning","Cashed Out","Loose","Gambling","Risky","Loaded","Opulent"]
            stagenouns = [["Casino","Casinoes"],["Blackjack","Blackjack"],["Bet","Bets"],["Card","Cards"],["Cash","Cash"],["Chip","Chips"],["Damage","Damages"],["Dealer","Dealers"],["Die","Dice"],["Gambler","Gamblers"],["Hand","Hand"],["House","House"],["Money","Money"],["Odds","Odds"],["Poker","Poker"]]
        break;
        case "Compromised":
            stageadjectives = ["Compromised","Armed","Rising","Misguided","Calming","Scared","Panicking"]
            stagenouns = [["Downtown","Downtown"],["Panic","Panic"],["Hostage","Hostages"],["Intruder","Intruders"],["Bribe","Bribes"],["Offices","Offices"],["Threat","Threats"],["Fear","Fear"],["Heroic","Heroic"],["Word","Words"],["Staff","Staff"],["Security System","Security Systems"]]
        break;
        case "Gone Ballistic":
            stageadjectives = ["Concealed","Proximity","Stray","Illegal","Explosive","Stolen","Ballistic","Bulletproof"]
            stagenouns = [["Dealer","Dealers"],["Grenade","Grenades"],["Gun","Guns"],["Mine","Mines"],["Rocket","Rockets"],["Sidearm","Sidearms"],["Supply","Supplies"],["Trigger","Triggers"],["Truck","Trucks"],["Vest","Vests"],["Weapon","Weapons"]]
        break;
        case "One Step Ahead": 
            stageadjectives = ["Steep","Windy","Strong","Climbing"]
            stagenouns = [["Mountain","Mountains"],["Step","Steps"],["Cliff","Cliffs"],["Grappling Hook","Grappling Hooks"],["Wind","Winds"],["Avalanche","Avalance"],["Vertigo","Vertigo"]]
        break;
        case "Original Copy": 
            stageadjectives = ["Duplicated","Mutated","Accelerated","Deadly","Regenerative","Experimental","Original","Dynasty"]
            stagenouns = [["Lab","Labs"],["Cell","Cells"],["Clone","Clones"],["Computer","Computers"],["Copy","Copies"],["Duplicate","Duplicates"],["Mutation","Mutations"],["Protocol","Protocols"],["Serum","Serums"],["Subject","Subjects"],["Test","Tests"],["Vandal","Vandal"],["Vat","Vats"]]
        break;
        case "Out of Time": 
            stageadjectives = ["Afflicted","Putrid","Fallen","Profane","Dead","Dimensional","Hellish"]
            stagenouns = [["Pit","Pits"],["World","Worlds"],["Spike","Spikes"],["Time","Time"],["Zombie","Zombies"],["Remnant","Remnants"],["Altar","Altars"],["Refuge","Refuges"],["Below","Below"],["Offering","Offerings"],["Undead","Undead"]]
        break;
        case "Poison the Well": 
            stageadjectives = ["Poisoned","Infected","Addicted","Filthy","Stinking","Smelly","Insane","Subterranean","Underground"]
            stagenouns = [["Experiment","Experiment"],["Poison","Poison"],["Well","Wells"],["Sewer","Sewers"],["Vandal","Vandal"],["Vat","Vats"],["Addict","Addicts"],["Thrall","Thralls"],["City","City"],["Rat","Rats"],["Pursuit","Pursuit"]]
        break;
        case "Right to Remain Silent":
            stageadjectives = ["Blindfolded","Escaped","Silent","Recovered","Armed","Sneaking","Captured"]
            stagenouns = [["Right","Rights"],["Captive","Captives"],["Intel","Intel"],["Prisoner","Prisoners"],["Guard","Guards"],["Tripwire","Tripwires"],["Interrogation","Interrogation"]]
        break;
        case "Rude Awakening":
            stageadjectives = ["Rude","Afflicted","Decayed","Rotting","Summoned","Risen","Awakened","Rotten","Dark","Black"]
            stagenouns = [["Undead","Undead"],["Awakening","Awakening"],["Remnant","Remnants"],["Dead","Dead"],["Undead","Undead"],["Zombie","Zombies"],["Rot","Rots"],["Decay","Decay"],["Necromancer","Necromancers"],["Realm","Realms"],["Below","Below"]]
        break;
        case "Running Wild":
            stageadjectives = ["Unturned","Blessed","Wild","Lost","Hidden","Buried","Final"]
            stagenouns = [["Shrine","Shrines"],["Search","Search"],["Demon","Demons"],["Wild","Wilds"],["Key","Keys"],["Hunt","Hunt"],["Idol","Idols"],["Blessing","Blessings"],["Beyond","Beyond"],["Oni","Oni"],["Curse","Curses"],["Tree","Trees"],["Trail","Trail"],["Call","Call"]]
        break;
        case "Steel Memories":
            stageadjectives = ["Steel","Fresh","True","Demoralizing","Upcoming","Surrounded","Dark","Brutal"]
            stagenouns = [["Melee","Melee"],["Memory","Memories"],["Recruit","Recruits"],["Crowbar","Crowbars"],["Underdog","Underdogs"],["Edge","Edges"],["Defeat","Defeat"],["Finisher","Finisher"],["Challenger","Challengers"],["Contest","Contests"],["Challenge","Challenges"]]
        break;
        case "Sudden Death":
            stageadjectives = ["Sudden","Culling","Personal","Mutual","New","Overconfident","Urban","Deadly","Ruthless","Underground","Brutal"]
            stagenouns = [["Death","Death"],["Vendetta","Vendetta"],["Assistance","Assistance"],["Cause","Causes"],["Challenger","Challengers"],["Competition","Competition"],["Tournament","Tournament"],["Contest","Contests"]]
        break;
        case "Supply & Demand":
            stageadjectives = ["Distribution","Pinned","Rising","Hooked","Addicted","Dealing","Pushing"]
            stagenouns = [["Supply","Supplies"],["Demand","Demand"],["Crossfire","Crossfire"],[`Island`,`Islands`],["Drug","Drugs"],["Smuggler","Smugglers"],["Network","Networks"],["Kingpin","Kingpin"],["Drive-By","Drive-By"],["Contraband","Contraband"],["Island","Islands"],["Beach","Beaches"],["Camp","Camps"]]
        break;
        case "The Ceremony":
            stageadjectives = ["Eldritch","Whispered","Unholy","Unclean","Ceremonial"]
            stagenouns = [["Ceremony","Ceremony"],["Alignment","Alignment"],["Vessel","Vessels"],["Embrace","Embrace"],["Unclean","Unclean"],["Lure","Lures"],["Promise","Promises"],["Conduit","Conduits"],["Oni","Oni"],["Demon","Demons"],["Servant","Servants"]]
        break;
        case "Under Destruction":
            stageadjectives = ["Risky","Collateral","Timed","Remote","Armed","Explosive","Demolished"]
            stagenouns = [["Explosion","Explosions"],["Destruction","Destruction"],["Conveyor","Conveyor"],["Demolition","Demolitions"],["Buzzsaw","Buzzsaws"],["Bomb","Bombs"],["Construction","Construction"],["Trigger","Triggers"]]
        break;
        default:
            stageadjectives = adjectives
            stagenouns = nouns
    }
    
    adjectives = _.union(adjectives,bossadjectives,stageadjectives)
    nouns = _.union(nouns,bossnouns,stagenouns)
    
    let plural = randFrom([0,1])

    let storyname = ""
    switch (Math.floor((Math.random() * number) + 1)) {
        case 1: storyname = randFrom(adjectives) + " " + randFrom(nouns)[plural];
        break;
        case 2: storyname = randFrom(adjectives) + " " + randFrom(nouns)[0] + " " + randFrom(nouns)[plural]
        break;
        case 3: storyname = randFrom(adjectives) + " " + randFrom(adjectives) + " " + randFrom(nouns)[plural]
        break;
        case 4: storyname = randFrom(adjectives) + " " + randFrom(nouns)[plural] + ", " + randFrom(adjectives) + " " + randFrom(nouns)[plural]
        break;
        case 5: storyname = randFrom(nouns)[plural] + " of the " + randFrom(adjectives)
        break;
        case 6: storyname = randFrom(nouns)[0] + " " + randFrom(nouns)[plural]
        break;
        case 7: storyname = randFrom(nouns)[0] + " " + randFrom(nouns)[0]
        break;
        case 8: storyname = randFrom(nouns)[plural] + " of" + (plural == 0 ? " the " : " ") + randFrom(nouns)[(plural == 0 ? 0 : 1)]
        break;
        case 9: storyname = randFrom(nouns)[0] + " of the " + randFrom(nouns)[0] + " " + randFrom(nouns)[0]
        break;
        case 10: storyname = randFrom(nouns)[0] + " " + randFrom(nouns)[0] + " " + randFrom(nouns)[plural]
        break;
        case 11: storyname = randFrom(nouns)[plural] + " and " + randFrom(nouns)[plural]
        break;
        case 12: storyname = randFrom(nouns)[0] + ": " + storyNamer(finalboss,finalstage,15)
        break;
        case 13: storyname = randFrom(nouns)[0] + " for " + (plural == 0 ? " the " : "") + randFrom(nouns)[plural]
        break;
        case 14: storyname = "From the " + randFrom(adjectives) + " " + randFrom(nouns)[0]
        break;
        case 15: storyname = randFrom([`Another ${randFrom(nouns)[0]}`,`For ${randFrom(nouns)[plural]}`,`Enter the ${randFrom(nouns)[plural]}`,`The ${randFrom([randFrom(adjectives),randFrom(nouns)[plural]])}`])
        break;
        case 16: storyname = storyNamer(finalboss,finalstage, 15) + randFrom([": the Return"," - Part Two", " - Part One", ": the Final Chapter"])
        break;
        default: storyname = "New Rise of the Kingdom"
}

//käy läpi substantiivit
/*for (i = 0; i < nouns.length; i++) {
    console.log(nouns[i][0] + " - " + nouns[i][1])
}*/

storyname.length > 42 ? storyNamer(finalboss,finalstage, 15) : ``

return storyname.toUpperCase();

}

function compileStory(stages, enemies) {

    
    let story = []
    
    let chapters = ["1","2A","2B","3A","3B","4A","4B","5A","5B"];
    
    var chapter
    for (i = 0; i < chapters.length; i++) {
        chapter = {chapter: chapters[i], stage: stages[i], enemy: enemies[i]}
        story.push(chapter)
    }
    
    return story

}

function storyStages(stages) {



let storystages = []
let randomstage = Math.floor(Math.random()*stages.length);

let finalstage = stages[randomstage];
stages.splice(randomstage, 1);

randomstage = Math.floor(Math.random()*stages.length);

storystages.push(stages[randomstage]);
stages[randomstage].instory = stages[randomstage].instory + 1
stages = cleanStages(stages);


do {

(Math.random() < 0.75 ? 
    (randomstage = Math.floor(Math.random()*stages.length),
    storystages.push(stages[randomstage]),
    stages[randomstage].instory = stages[randomstage].instory + 1,
    (stages[randomstage].instory < 2 ?
        (storystages.push(stages[randomstage]),
        stages[randomstage].instory = stages[randomstage].instory + 1,
        stages = cleanStages(stages)) :
        (stages = cleanStages(stages),
            randomstage = Math.floor(Math.random()*stages.length),
            storystages.push(stages[randomstage]),
            stages[randomstage].instory = stages[randomstage].instory + 1,
            stages = cleanStages(stages))
    )
                ) :
    (randomstage = Math.floor(Math.random()*stages.length),
    storystages.push(stages[randomstage]),
    stages[randomstage].instory = stages[randomstage].instory + 1,
    stages = cleanStages(stages),
    randomstage = Math.floor(Math.random()*stages.length),
    storystages.push(stages[randomstage]),
    stages[randomstage].instory = stages[randomstage].instory + 1,
    stages = cleanStages(stages))
)

} while (storystages.length < 7);

(Math.random() < 0.75 ? 
    
    (storystages.push(finalstage),
    storystages.push(finalstage)) :
    (storystages.push(finalstage),
    storystages.push(stages[Math.floor(Math.random()*stages.length)])))

return [storystages, stages]
    
}

function loungeMusic() {
    
    let music = randFrom(["Don't Stop Believing","Faithfully","Don't Stop Me Now","Open Arms","Wheel in the Sky","Separate Ways","Livin' on a Prayer","Any Way You Want It",
    "Eye of the Tiger","The Final Countdown","Burning Heart","Every Breath You Take","Another One Bites the Dust","Never Gonna Give You Up"])
    
    return music
}

function storyEnemies(storystages, enemies) {


let randomenemy = Math.floor(Math.random()*enemies.length);
let storyenemies = []
let finalboss = enemies[randomenemy];
enemies.splice(randomenemy, 1);

(Math.random() < 0.5 ? 
    (storyenemies.push(finalboss)) :
    (randomenemy = Math.floor(Math.random()*enemies.length),
    storyenemies.push(enemies[randomenemy]),
    enemies.splice(randomenemy, 1)))
    
for (i = 0; storyenemies.length < 7; i++) {

(Math.random() < 0.7 ? 
    
    (randomenemy = Math.floor(Math.random()*enemies.length),
    storyenemies.push(enemies[randomenemy]),
    storyenemies.push(enemies[randomenemy]),
    enemies.splice(randomenemy, 1)) :
    (randomenemy = Math.floor(Math.random()*enemies.length),
    storyenemies.push(enemies[randomenemy]),
    enemies.splice(randomenemy, 1),
    randomenemy = Math.floor(Math.random()*enemies.length),
    storyenemies.push(enemies[randomenemy]),
    enemies.splice(randomenemy, 1)))

}

storyenemies.push(finalboss);

if (storystages[7].name == storystages[8].name) {
storyenemies.push(finalboss);
} else {
    randomenemy = Math.floor(Math.random()*enemies.length);
    storyenemies.push(enemies[randomenemy]);
    enemies.splice(randomenemy, 1);
}


return [storyenemies, enemies]
    
}

function evilPlace() {
    
    let evilterm = ["ancient", "cursed", "damned", "eldritch", "evil", "unholy", "unclean", "vile"]
    let place = ["burial ground", "altar", "sanctum", "shrine", "temple"]
    
    let evilplace = //evilterm.splice(Math.floor(Math.random()*evilterm.length), 1) + " and " + 
    evilterm.splice(Math.floor(Math.random()*evilterm.length), 1) + " " + 
    place.splice(Math.floor(Math.random()*place.length), 1)
        
    return evilplace
}

function possessiveSuffix (name) {
    
    let suffix = ((name).charAt((name).length-1) != "s" ? "'s" : "'")
    
    return suffix
}

function allyNamer (alliesandrivals, enemy, heronames) {
    
    let ally = randFrom(alliesandrivals)
    
    while (ally.name === enemy.boss && heronames.includes(ally.name)) {
        ally = randFrom(alliesandrivals)
    }
    
    let allyname = String(ally.name)
    
    if (ally.name === enemy.boss) {allyname = "Mirror " + ally.name}
    else if (heronames.includes(ally.name)) {allyname = "Shadow " + ally.name}
    
    return allyname
}

function defineKnowledge(i, story) {
    let knowledge
    
    switch (i) {
    case 0: knowledge = (Math.random() < 0.5 ? "coldtrail" : "clueless")
    break;
    case 1: case 3: case 5: case 7:
        knowledge = "hottrail"
    break;
    case 2: case 4: case 6: case 8:
        if (story[i].stage.name === story[i-1].stage.name) {
            knowledge = "coldtrail"
        } else knowledge = "clueless"
    break;
}

    return knowledge
}

function loseResult(stageindex, story, nextstage) {
    
    let finalboss = story[7].enemy
    
    let enemy = story[stageindex].enemy
    
    let nextenemy = story[nextstage].enemy
    
    let nextmission = story[nextstage].stage
    
    let altstage = (nextstage - 1)
    
    let minion = randFrom(enemy.minionnames)
    
    let nextminion = randFrom(nextenemy.minionnames)
    
    let evilplace = evilPlace()
    
    let contact = Math.random() < 0.5 ? "He" : "She"
    
    let gizmo = randFrom(["data disc","keycard","tape recorder","floppy disc","microchip","communicator","dossier","cell phone","map","notepad","diskette","data cartridge"])
    
    let goal
    
    let captivity = ["Ashes of the Eternal", "Original Copy", "Out of Time", "Poison the Well","Right to Remain Silent", "Under Destruction", "Steel Memories", "Sudden Death"]
    
    
    //erottele tällä tarkemmin lopetukset
    switch (story[stageindex].stage.name) {
    case "Ashes of the Eternal": 
    case "Out of Time": 
    case "The Ceremony": goal = "ritual"
    break;
    case "Cashed Out":
    case "Compromised":
    case "Gone Ballistic":
    case "One Step Ahead":
    case "Original Copy":
    case "Right to Remain Silent":
    case "Running Wild":
    case "Supply & Demand": goal = "retrieval"
    break;
    case "Poison the Well": 
    case "Under Destruction":
    case "Rude Awakening":
    case "Steel Memories": 
    case "Sudden Death": goal = "terror"
    break;
    }
   
    let goingdown = [
        `${enemy.boss} kicks you while you're down, and then pushes you hard into the ground. You look up slowly to see two others join him — ${nextenemy.boss} and ${nextminion} of the ${nextenemy.name}.
        "Wholly unimpressive," ${nextenemy.boss} comments.  "Perhaps, with a little more work, they can become somehow... useful?" `,
        `${enemy.boss} looks down at you. "So this is the sad excuse for a fighter that has been harrying the ${finalboss.name}?" ${genderPronoun(enemy.sex,"subject")} says looking you over. "You've thrown a wrench
        in our plans, ${enemy.addressing}." And then ${genderPronoun(enemy.sex,"subject")} grins, and you feel your heart stop. "And so now you will go to ${nextenemy.boss}!", and then laughs at your fate.`,
        `"Just as I thought," ${enemy.boss} says with calm confidence as he paces around you. "Absolutely pathetic." "What should we do with them?" ${minion} asks. "They are worthless."<br><br>"Not entirely," 
        ${enemy.boss} says. "Bind them. Perhaps ${nextenemy.boss} will have a use for their inadequate talents."`,
        `"Your pitiful husks won't serve me," ${enemy.boss} says. "Perhaps you'll be worth something on the black market. ${upperCaseInitial(genderPronoun(enemy.sex,"possessive"))} ${enemy.minions} approach to apprehend you.`,
        `${enemy.boss} ${enemy.threat} before ${nextenemy.boss} gestures for ${genderPronoun(enemy.sex,"object")} to stop. "No," ${genderPronoun(nextenemy.sex,"subject")} says. We have a better use for the Gladiators. 
        After all, who better to think ${finalboss.boss} would want than the Citadel's best?" ${minion} and ${nextenemy.boss} share an amused glance as ${enemy.boss} opens a secret passage. The three of them lead you to the unknown.`,
        `Cackling maniacally the whole time, ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} ${enemy.minions} surround you, overwhelming you. Their constant attacks became too much for you, and soon you blacked out,
        ${enemy.boss}${possessiveSuffix(enemy.boss)} haunting laughter echoing through your head all the while.`,
        `${enemy.boss} laughed quietly and sinisterly as he slowly licked a bleeding wound on ${genderPronoun(enemy.sex,"possessive")} hand. "${finalboss.boss == enemy.boss ? `I'm proud of you` : `${finalboss.boss} would be proud` }," ${genderPronoun(enemy.sex,"subject")} told the you were tied as
        your vision faded. You barely heard ${enemy.boss}${possessiveSuffix(enemy.boss)} final command: "Take them to the ${nextenemy.name}!"`,
        `You barely clear the site, and you find yourself immediately surrounded by ${enemy.boss}${possessiveSuffix(enemy.boss)} ${enemy.minions}. "You're due at the next stop," ${enemy.boss} said menacingly.
        "The ${nextenemy.name} still has some uses for you.`
        ]
    
    let deusexmachina = [
        `Suddenly, Citadel agents rappel down out of nowhere. ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} ${enemy.minions} flee as the agents free you.
        "Gladiators," one of the Agents greets you. "I have a location of heavy ${nextenemy.name} activity that could use your particular brand of investigating.`,
        `You were unable to learn anything important before your retreat, and when you reconnect with Agent Fletch, he has a little time to debrief you.<br><br>While you were bumbling, the Citadel's efforts have paid off, and you have a little time to recover before you're
        sent off to your next target, where ${nextenemy.boss} has been seen.`,
        `You retreat and regroup nearby, having lost to ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} forces. You overheard a lead, but it will be a struggle for you to catch up with the
        ${finalboss.name}${possessiveSuffix(finalboss.name)} plans now.`,
        `You slowly awoke in a helicopter, confused how you wound up here. Agent Fletch leans towards you, shouting over the roar of the vehicle. "No idea what you thought you were doing down there. Now we must hurry to ${nextenemy.name}
        if we're to fix this!"`,
        `As you were regrouping some distance away, you saw your first welcome sight; Agent Fletch approached with a tablet under his arm. "Don't get comfy," Fletch said, booting up the tablet. "After this fiasco, we might recover if we rapidly strike at key
        targets, and hopefully throw the ${finalboss.name} off-balance."`,
        `Overwhelmed by the might of the ${enemy.name}, you're forced to flee with no real leads to follow up. However, after returning to HQ, the news reported on a situation that guides you on where to go next.`,
        `After failing to contain the situation, you were forced to flee from ${enemy.name}${possessiveSuffix(enemy.name)} forces. Ashamed and frustrated, you have no choice but to return to the city and hope
        someone at the police department would hear you out. You can't think of any other option at this point.`
        ]
        
    if (goal == "retrieval") {
        deusexmachina = deusexmachina.concat([
        `The ${enemy.name} was able to escape with their plan fulfilled. You call Agent Fletch and request a cleanup team at the site, and then you begin searching through the debris. You find a ${gizmo} placed almost intentionally
        where you would find it.`,
        `After an uphill battle against overwhelming odds, ${enemy.boss} apparently became bored with the uneven competition and suddenly assaulted with unprecedented fury, leaving you beaten. "Let's move out!" ${genderPronoun(nextenemy.sex,"subject")}
        commanded.  "This is not worth our time."<br><br>Left for dead, you had no chance of following, and had very little to proceed with.`,
        `The ${enemy.name} escaped with what they wanted, and a ${gizmo} you happened upon looks damaged. "Agent Fletch," you got into your communications device. "I've found a ${gizmo}, but it looks damaged." "At least we have it,"
        Agent Fletch replied in your ear. "Bring it back to Citadel HQ and we'll see what can we pull from it."`,
        `You ducked behind cover as ${enemy.minions} mounted a huge assault. To move would have been suicide, and you were forced to watch as the enemy retreated, retrieveing whatever they planned to. While you were avoiding being hit, a squad of Citadel soldiers rushed in
        and sent off the enemies focused on you.<br><br>The soldiers took a moment to patch up your wounds, getting you prepared to return to the Citadel and receive your next target.`,
            ])
    }
    
    if ([2,4,6].includes(stageindex) && captivity.includes(story[stageindex].stage.name)) {
        deusexmachina = [
        `Suddenly, Citadel agents rappel down out of nowhere. ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} ${enemy.minions} flee as the agents free you.
        "Gladiators," one of the Agents greets you. "I have a location of heavy ${nextenemy.name} activity that could use your particular brand of investigating.`,
        `You espaced, but badly beaten, and were unable to learn anything important. When you reconnect with Agent Fletch, he has a little time to debrief you.<br><br>The Citadel's efforts have paid off, and you have a little time to recover before you're
        sent off to your next target, where ${nextenemy.boss} has been seen.`,
        `You slowly awoke in a helicopter, confused how you wound up here. Agent Fletch leans towards you, shouting over the roar of the vehicle. "No idea what you thought you were doing down there. Now we must hurry to the ${nextenemy.name}
        if we're to fix this!"`,
        `Overwhelmed by the might of the ${enemy.name}, you're manage to flee, clinging to your lives, and not a clue what to do next. After returning to HQ, the news reported on a situation that guides you on where to go next.`,
        `Severy beaten by ${enemy.name}${possessiveSuffix(enemy.name)} forces, you barely espace. Ashamed and frustrated, you have no choice but to return to the city and hope
        someone at the police department would hear you out. You can't think of any other option at this point.`
            ]
    }
        
    let loseresult
    
    if ((story[altstage].stage.name != nextmission.name) && captivity.includes(nextmission.name)) {loseresult = randFrom(goingdown)}
    else {loseresult = randFrom(deusexmachina)}
    
    if (goal == "ritual") {loseresult = `You were not able to stop ${enemy.boss} from completing the ritual!
    Standing in the middle of the temple, ${genderPronoun(enemy.sex,"subject")} rises up off the stone floor, the ${mysticalSynonym()} powers swirling around ${genderPronoun(enemy.sex,"object")}.
    You watch as ${genderPronoun(enemy.sex,"possessive")} eyes burn, and ${genderPronoun(enemy.sex,"possessive")} body pulses with the ancient energies! 
    ${story[altstage].stage.name != nextmission.name ? `You lose consciousness in front of that ${mysticalSynonym()} power!` : `You have no choice but to flee for your lives!`}`}
    
    return loseresult
}

function victoryResult(stageindex, story, nextstage) {
    
    let finalboss = story[7].enemy
    
    let enemy = story[stageindex].enemy
    
    let nextenemy = story[nextstage].enemy
    
    let nextmission = story[nextstage].stage
    
    let minion = randFrom(enemy.minionnames)
    
    let contact = randFrom(["He","She"])
    
    let location
    
    let bystanders
    
    let clue
    
    let evilplace = evilPlace()
    
    let gizmo = randFrom(["data disc","keycard","tape recorder","floppy disc","microchip","communicator","dossier","cell phone","map","notepad","diskette","computer","magnetic tape"])
    
    
    switch (story[stageindex].stage.name) {
    case "Ashes of the Eternal": 
    case "The Ceremony":
    case "Out of Time": 
    case "Rude Awakening": location = "cursed", bystanders = "unwitting acolyte"
    break;
    case "Cashed Out": location = "base", bystanders = "gambler"
    break;
    case "Compromised": location = "remote", bystanders = "hostage"
    break;
    case "Gone Ballistic": location = "neutral", bystanders = "hireling"
    break;
    case "One Step Ahead": location = "remote", bystanders = "civilian"
    break;
    case "Original Copy": location = "base",bystanders = "scientist"
    break;
    case "Poison the Well": location = "neutral", bystanders = "hireling"
    break;
    case "Right to Remain Silent": location = "base", bystanders = "captive"
    break;
    case "Supply & Demand": location = "neutral", bystanders = "hireling"
    break;
    case "Under Destruction": location = "neutral", bystanders = "construction worker"
    break;
    case "Running Wild": location = "remote", bystanders = "civilian"
    break;
    case "Steel Memories": location = "base", bystanders = "fighter"
    break;
    case "Sudden Death": location = "base", bystanders = "nameless goon"
    break;
    }

    let wanting = randFrom(["you are after","you want","","you pursuit","the Citadel is after","behind all this","all to familiar"])
    let finalcahoots = finalboss.name == nextenemy.name ? randFrom([finalboss.boss, (finalboss.desc.replace("the", "a certain"), finalboss.bosstitle)]) : randFrom([`the ${finalboss.name}`, `${finalboss.desc} ${wanting}`, `${finalboss.minions} ${wanting}`, `the ${finalboss.bosstitle} ${wanting}`, finalboss.boss])
    let thiscahoots = enemy.name == nextenemy.name ? randFrom([enemy.boss, (enemy.desc.replace("the", "this very")),`this ${enemy.bosstitle}`]) : randFrom([`the ${enemy.name}`, (enemy.desc.replace("the", "this")), `these ${enemy.minions}`, `the ${enemy.bosstitle}`, enemy.boss])
    let cahoots = randFrom([finalcahoots,thiscahoots])
    let supposition = randFrom(["","supposedly ","rumored to be ","who to your understanding are ","who, according to Agent Fletch, are ","apparently ","probably ","believed to be ","most likely ","in all likelihood ",
    "presumably ","surely ","assumably ","which you believe are ", "the Citadel analysts are saying is ", "apparently ", "in fact ","indeed ","as a matter of fact ","in truth "])
    cahoots = randFrom([``,` - ${supposition}in cahoots with ${cahoots}`, `, ${supposition}in league with ${cahoots}`,`, ${supposition}allied to ${cahoots}`, 
        `, ${supposition}working for ${cahoots} this time`,`, ${supposition}in alliance with ${cahoots}`,`, ${supposition}hired by ${cahoots}`, `, ${supposition}linked to ${cahoots}`, `, ${supposition}tied to ${cahoots}`,
        `, ${supposition}connected to ${cahoots}`],`, somehow connected to all of this`,``,` that ${supposition}is connected to this`,`, that the Citadel confirms warrants further investigation`,`, who doesn't serve the Kingdom, but instead someone known only as The Master`,`, and seems more important than you originally thought`)
    cahoots = (nextstage == 7 || nextstage == 8) ? `` : cahoots
    
    switch (nextmission.name) {
    case "Ashes of the Eternal": 
    case "The Ceremony": clue = `${nextenemy.boss}${cahoots}, has an interest on a certain ${evilplace}`
    break;
    case "Cashed Out": clue = `the location of a gambling den operated by the ${nextenemy.name}${cahoots}`
    break;
    case "Compromised": clue = `${nextenemy.boss} planning to take hostages in a downtown office building${cahoots}`
    break;
    case "Gone Ballistic": clue = `${nextenemy.name} - ${nextenemy.desc}${cahoots} - are conducting an arms deal at a nearby warehouse`
    break;
    case "One Step Ahead": clue = `the ${nextenemy.name} are guarding an arduous mountain path with their ${nextenemy.minions}${cahoots}`
    break;
    case "Original Copy": clue = `${nextenemy.boss} and ${genderPronoun(nextenemy.sex,"possessive")} ${nextenemy.minions}${cahoots}, have been spotted at a suspicious lab`
    break;
    case "Out of Time": 
    case "Rude Awakening": clue = `strange sorcery and walking corpses have been again witnessed, along with ${nextenemy.boss} in ${whichPreposition(evilplace)} ${evilplace}${cahoots}`
    break;
    case "Poison the Well": clue = `the ${nextenemy.name} has hauled some equipment to the sewers${cahoots}`
    break;
    case "Right to Remain Silent": clue = `the ${nextenemy.name} has imprisoned Citadel scouts${cahoots}`
    break;
    case "Supply & Demand": clue = `${nextenemy.name} - ${nextenemy.desc}${cahoots} - are conducting a drug deal at a nearby warehouse`
    break;
    case "Under Destruction": clue = `the ${nextenemy.name}${cahoots} - had been busy setting up an intricate series of explosives to bring a certain building down`
    break;
    case "Running Wild": clue = `${nextenemy.minions} of the ${nextenemy.name}${cahoots}, are in a nearby labyrinthine forest, searching for something`
    break;
    case "Steel Memories": clue =`${nextenemy.boss} has a secret underground base${cahoots}`
    break;
    case "Sudden Death": clue = `the ${nextenemy.name == "Kingdom" ? nextenemy.boss  + ` was back to ${genderPronoun(nextenemy.sex,"possessive")} previous practice` : " the customary recruitment methods of the Kingdom have been duplicated by " + nextenemy.name}${cahoots}`
    break;
    }
    
    let gatherclues = [
        `${enemy.boss} forces you to dodge ${genderPronoun(enemy.sex,"possessive")} attack, and when you return to your stance, ${genderPronoun(enemy.sex,"subject")} is gone! Rather than give chase, you interrogate ${minion} who reveals`,
        `After the skirmish, the ${enemy.name} scared away, you rush to one of the ${bystanders}s' side - an undercover Citadel scout, who holds ${whichPreposition(gizmo)} ${gizmo} in hand. ${contact}'s alive, bleeding out from an attack. "The ${gizmo}!" you ask. "What's in it?" ${contact} doesn't make it, but the intel you recovered tells`,
        `Before you can finish the job, ${enemy.boss} leaps through an opening, falling straight down quite a way but seemingly unharmed. You turn to the ${bystanders}s and one of them approaches you.  "Thank you!" ${lowerCaseInitial(contact)} says, and tells of overhearing that`,
        `As you tie up the unconscious members of the ${enemy.name}, left on their own devices by ${enemy.boss}, you're shocked when ${minion} approaches you calmly. ${minion} - a double agent - informs you that `,
        `"Sir, we've captured one of the ${enemy.minions} and are holding them for questioning."  The technician got to Agent Fletch, and then paused for a moment.  "Find out what they are up to!" Fletch told the technician.  "By any means necessary!" ${minion} revealed that`,
        `${enemy.boss} made a hasty retreat, but thanks to the information you got after the encounter, you have learned`,
        `"Thank you!" one of the ${bystanders}s said as ${lowerCaseInitial(contact)} approached, as the forces of ${enemy.boss} made their retreat. "I overheard what they're planning." ${contact} continues that `,
        `With the last of the ${enemy.minions} defeated, you turn to face ${enemy.boss} again. You're confident that if you could only get close to ${genderPronoun(enemy.sex,"object")}, you could end this game of cat and mouse. But ${genderPronoun(enemy.sex,"subject")} has disappeared into the thin air! You don't have the time to ponder this, as the intel from here tells`,
        `After your victory over ${enemy.boss}${possessiveSuffix(enemy.boss)} goons and a short call to Agent Fletch, Citadel forces secure the area and begin their investigation with you. ${enemy.boss} might have slipped away, but among the debris of the fight, you find out`
        ]
        
    if (location == "base") {
        gatherclues = gatherclues.concat([
        `With a hail of attacks, ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} surviving cronies fled the encounter. Taking a moment to catch your breath, you managed to find the most conscious of the ${bystanders}s. "He never told us the plan!" ${lowerCaseInitial(contact)} cried.  "All I know is that`,
        `Accessing ${enemy.boss}${possessiveSuffix(enemy.boss)} ${gizmo}, you are able to determine that`,
        `"You think you have won?"  ${enemy.boss} says you're closing in. "You have won nothing!" ${genderPronoun(enemy.sex,"subject")} produces a remote and presses a button. An explosion knocks you down, and the floor collapses beneath you as ${genderPronoun(enemy.sex,"subject")} escapes. You save who you can and ${minion} returns the favor by telling you that`,
        `With the Citadel on the way, you head deeper to find an array of computer screens. Sifting through files, you learn that`,
        `Accessing ${enemy.boss}${possessiveSuffix(enemy.boss)} files, you were able to determine that `,
        `You snatch up a ${gizmo} and press the communications device in your ear.  "I've got some intel."  "Excellent," Agent Fletch responds.  "We'll see what data we can pull from it." Turns out`,
        `After the fight, with no sight of ${enemy.boss}, you couldn't help but wonder what ${genderPronoun(enemy.sex,"subject")} was trying to cover up with this. Inside you found a ${gizmo} with intel that ${enemy.boss} definitely didn't want you to find:`,
        ])
    } else if (location == "neutral") {
        gatherclues = gatherclues.concat([
        `"You think you have won?"  ${enemy.boss} says you're closing in. "You have won nothing!" ${genderPronoun(enemy.sex,"subject")} produces a remote and presses a button. An explosion knocks you down, and the floor collapses beneath you as ${genderPronoun(enemy.sex,"subject")} escapes. You save who you can and ${minion} returns the favor by telling you`,
        `After the fight, with no sight of ${enemy.boss}, you couldn't help but wonder what ${genderPronoun(enemy.sex,"subject")} was trying to cover up with this. Inside you found a ${gizmo} with intel that ${enemy.boss} definitely didn't want you to find:`,
        ])
    } else if (location == "cursed") {
        gatherclues = gatherclues.concat([
        `You were strong and fast enough to prevent ${enemy.boss} from finishing the ritual, the ${mysticalSynonym()} powers dissipating into the temple like a voice on the wind. You search through the area, and find out that`,
        `With each blow to ${enemy.boss}, the very world around you shudders. ${upperCaseInitial(genderPronoun(enemy.sex,"object"))} screams of pain carry on the winds around you as ${genderPronoun(enemy.sex,"subject")} attempts to fight you off.  Suddenly there's blinding flash and ${genderPronoun(enemy.sex,"subject")}'s gone. You can only look throuh what's left, and you determine that`,
    ])}
    
    let planning = [`. You decide to pay them a visit.`, `. Agent Fletch suggests you continue your investigations there.`, `. A frightened ${bystanders} begs you to hurry up!`, `, and you think there really is no other option than to investigate.`, `. Perhaps it is time to visit ${nextenemy.boss}.`]

    let finalclue = randFrom([`where ${finalboss.boss} is waiting for you.`,`where your final showdown will go down!`, `the critical piece of information that leads you to the location of ${finalboss.boss}!`, `where ${finalboss.boss} is!`, `where the fight to end this will be.`, `the location where your ultimate destiny lies.`, `${nextenemy.boss} in fact is where all the clues were pointing at.`])
    let finality = randFrom([``,`You're going to stop this once and for all.`,`You prepare for a fight this one last time.`,`This is it.`,`This is the end, at last.`,`No escape for ${finalboss.boss} now!`,`You can almost taste the victory`,`Everything has led to this moment.`,`It is in your hands now.`])

    let victoryresult = (nextstage == 7) ? randFrom(gatherclues).replace(" that","").replace("continues","reveals") + " " + finalclue + " " + finality : randFrom(gatherclues) + " " + clue + randFrom(planning)
    
    return victoryresult
}

function determineNextStage(stageindex, story, result) {
    
    let nextstage

    if (result == 1) {
    switch (stageindex) {
        case 0: nextstage = 1
        break;
        case 1: case 2: nextstage = 3
        break;
        case 3: case 4: nextstage = 5
        break;
        case 5: case 6: nextstage = 7
        break;
        default: nextstage = 0
    }
    } else if (result == 0) {
        switch (stageindex) {
        case 0: nextstage = 2
        break;
        case 1: case 2: nextstage = 4
        break;
        case 3: case 4: nextstage = 6
        break;
        case 5: case 6: nextstage = 8
        break;
        default: nextstage = 0
    }
    }
    
    
    return nextstage
}

function getRandomMinions(enemy, enemies) {
    
    let clones = randFrom(enemiescopy)

    while (clones.name === enemy.name) {clones = randFrom(enemies)}
    
    return `${Math.random() < 0.5 ? clones.minionnames[0] : clones.minionnames[1]} from the ${clones.name}`
    
}

function setUpInstructions(stageindex,enemy,rival,rival2,knowledge,stagebonus,stagemalus) {
    
    let addrival = knowledge == "hottrail" ? false : randFrom([true,false])
    
    let penalty = Math.max(0,Math.round(stageindex/3))
    
    if (knowledge == "clueless") {
        penalty = penalty + 1
    } else if (knowledge == "hottrail") {
        penalty = penalty - 1
    } else {penalty = penalty}

    //gladiator, stage and boss  difficulty, if implemented :
    
    //penalty = penalty + round(round(grating)+srating+brating)
    
    //add cards that add to story pool
    //gettin a positive card nets increased difficulty!
    
    penalty < 1 ? addrival = false : addrival = addrival
    
    let putthiscardintoplay = false
    let activate = false
    let rivalaggression = false
    
    let preparedboss
    
    switch(enemy.boss) {
        case "Ah Long": preparedboss = ["Invincible Armor", "and put it into play"];
        break;
        case "Dmitri": preparedboss = ["Trusty Kevlar", "and put it into play"];
        break;
        case "Jackal": preparedboss = ["Neural Invasion","and play it"];
        break;
        case "Juan": preparedboss = ["On Alert","and put it into play"];
        break;
        case "Kemono": preparedboss = ["Uncontrollable Surge","and put it into play"]
        break;
        case "Mack": preparedboss = ["Taking Aim","and put it into play"];
        break;
        case "Shadow": preparedboss = ["Prescience","and put it into play"];
        break;
        case "Tlazolteotl": preparedboss = ["Foul Prophecy","and play it"]
        break;
        case "Yokai": preparedboss = ["Shadow Swarm","and play it"];
        break;
        default: preparedboss = ["A defensive card","and play it"]
    }
    
    let genericbonus = [["Each fighter may take a second mulligan.",false,false,false],["Each fighter gains 1 random defense token.",false,false,false],[`Search the enemy deck for ${preparedboss[0]} and discard it. Shuffle the enemy deck.`, false,false,false],["Each fighter may draw one loot card.",false,false,false]]
    
    let angryrival = [[`${rival} gains 1 of each type of defense token. Place ${rival} (rival) within 3 spaces of a fighter. Activate ${rival} (rival).`,false,false,true],[`${rival} (rival) gains 1 random defense token and advances 2 spaces toward the nearest fighter.<br>`,true,true,true],[`${rival} (rival) gains 2 random defese tokens.<br>`,true,true,false]]
    
    let instructions =  [[`If ${enemy.boss} is unengaged, ${genderPronoun(enemy.sex,"subject")} gains 1 defense token.`,true,true,false],[`Each fighter randomly discards 1 card.`,false,false,false],[`Each fighter suffers 1 direct damage.`,false,false,false],[`Search the enemy deck for ${preparedboss[0]}, ${preparedboss[1]}. Shuffle the enemy deck.`,false,false,false], [`${enemy.boss} gains 2 defense tokens of each type.`,false,false,false],[`${enemy.boss} gains +1 attack value.`,true,false,false]/*, [`Put ${rival2} (rival) into play.`,false,false,false]*/]
    
    addrival == true ? instructions = _.union(instructions, angryrival) : instructions = instructions
    
    let bonus = randFrom([stagebonus,randFrom(genericbonus)])
    
    if (penalty < 0) {
    (bonus[1] == true ? putthiscardintoplay = true : ``); (bonus[2] == true ? activate = true : ``)
    }
    
    let firstpenalty
    
    if (addrival == true && penalty > 0) {
        firstpenalty = [`Put ${rival} (rival) into play.`,false,false,false]
    } else if (penalty > 0) {
    let randpenalty = Math.floor(Math.random()*instructions.length)
    firstpenalty = instructions[randpenalty]
    instructions.splice(randpenalty,1)
    firstpenalty[1] == true ? putthiscardintoplay = true : ``; firstpenalty[2] == true ? activate = true : ``; firstpenalty[3] == true ? rivalaggression = true : ``; 
    }
    
    let secondpenalty
    
    if (penalty > 1) {
    secondpenalty = randFrom(instructions);
    secondpenalty[1] == true ? putthiscardintoplay = true : ``; secondpenalty[2] == true ? activate = true : ``; secondpenalty[3] == true ? rivalaggression = true : ``; 
    }
    
    if (penalty < 0) {
        instructions = `${putthiscardintoplay == true ? `Put this card into play in the enemy play area. ` : ``}${activate == true ? `<b>Activate:</b> ` : ``}${bonus[0]}`
    } else if (penalty == 0) {
        instructions = "No special setup."
    } else if (penalty == 1) {
        instructions = `${putthiscardintoplay == true ? `Put this card into play in the enemy play area. ` : ``}${activate == true ? `<b>Activate:</b> ` : ``}${firstpenalty[0]}`
    } else if (penalty > 1) {
        instructions = `${putthiscardintoplay == true ? `Put this card into play in the enemy play area. ` : ``}${firstpenalty[2] == false ? `${firstpenalty[0]} ` : ``}${secondpenalty[2] == false ? `${secondpenalty[0]} ` : ``}${activate == true ? `<b>Activate:</b> ` : ``}${firstpenalty[2] == true ? `${firstpenalty[0]}` : ``} ${secondpenalty[2] == true ? `${secondpenalty[0]}` : ``}`
    }
    
    instructions = `<b>Stage Setup:</b> ` + instructions
    
    instructionset = [instructions, addrival, rivalaggression]
    
    return(instructionset)
    
}

function createPrologue(stageindex, story, alliesandrivals, heronames, enemies,pregameprologue) {
    let finalboss = story[7].enemy
    let finalstage = story[7].stage
    let enemy = story[stageindex].enemy
    let stage = story[stageindex].stage
    let rival = allyNamer(alliesandrivals, enemy, heronames)
    let rival2 = allyNamer(alliesandrivals, enemy, heronames)
    let competitor = []; do {competitor = randFrom(enemiescopy)} while (finalboss.name == competitor.name || enemy.name == competitor.name)
    let knowledge = defineKnowledge(stageindex, story)
    let minion = randFrom(enemy.minionnames)
    let pregame = stageindex == 0 ? pregameprologue : "";
    ((enemy.boss != finalboss.boss) && stageindex == 0) ? pregame = pregame + `Without ${randFrom(["intel","knowledge","information","a clue","a word","lowdown"])} on the current ${randFrom(["locale","location","whereabouts","position","scene","station","bearings"])} of ${finalboss.boss}, ${randFrom(["Citadel analysts","you","Agent Flecth and you"])} ${randFrom(["believe","consider","conclude","suppose","think","regard","assume","postulate","deem","surmise"])} ${enemy.boss} is the best source for more information.<br><br>` : ``
    let trail = pregame + randFrom(["Based on current intel","Chasing the clues","Following your leads", "In pursuit of clues", "After a little more intel-gathering", "Following this lead", "As you investigated further", "After searching for more intel","Following the intel you had","After searching for more information","Reviewing what you got"]);
    let instructions
    let rivalpresence
    let rivalboost
    let setup = `<b>${stage.name}: ${enemy.name} ${enemy.name == "Kingdom" ? `(${enemy.boss})` : "" }</b><br>`
    let win = determineNextStage(stageindex, story, 1)
    let lose = determineNextStage(stageindex, story, 0)
    let winepilogue = (stageindex == 7 || stageindex == 8) ? `You have defeated the masterplan` : victoryResult(stageindex, story, win)
    winepilogue = winepilogue + "<br><br>" + `${(stageindex == 7 || stageindex == 8) ? `The fighters win this story` : `Advance to part ${story[win].chapter}`}.`
    let loseepilogue = (stageindex == 7 || stageindex == 8) ? `You have failed to defeat the masterplan` : loseResult(stageindex, story, lose)
    loseepilogue = loseepilogue + "<br><br>" + `${(stageindex == 7 || stageindex == 8) ? `The fighters lose this story` : `Advance to part ${story[lose].chapter}`}.`
    let gloat = gloatingList(enemy)

    switch (stage.name) {
    case "Ashes of the Eternal":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Any fighter may put this card in their play area. <b>Feint:</b> Remove this card from the game to discard 1 fire token from the map.`,false,false,false],[`The fighter places 1 fire token in the space nearest to them.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {
        prologue = `${trail}, ${enemy.boss}, the boss of ${enemy.name} is invoking an evil entity at a remote ${evilPlace()}. You have decided to head there.<br><br>
        And in the nick of time! When you arrive, the shrine has been set on fire to release the spirits. ${enemy.boss}${possessiveSuffix(enemy.boss)} goons are moving about the area, while the 
        ${enemy.bosstitle} ${genderPronoun(enemy.sex,"reflexive")} observes${rivalpresence == true ? ` with ${rival} at ${genderPronoun(enemy.sex,"object")} side,` : ``}. You rush to intervene, and ${enemy.boss} calls to you: "Is there no way a crime boss could just
        this once have ${genderPronoun(enemy.sex,"possessive")} ${mysticalSynonym()} ritual finished in peace?"<br><br>${laconicStatement()}.`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, ${enemy.desc} of ${enemy.name} is invoking an evil entity at a remote ${evilPlace()}. You have decided to head there.<br><br>
        Almost too late! When you arrive, the shrine is on fire, and the flames are getting higher! ${enemy.boss}${possessiveSuffix(enemy.boss)} goons are moving about the area, while the 
        ${enemy.bosstitle} ${genderPronoun(enemy.sex,"reflexive")} observes. You rush to intervene, and ${enemy.boss} calls to you: "Your efforts are futile, my plans are too far in motion!". ${laconicStatement()}.`}
        else {prologue = `${trail}, ${enemy.boss} is trying to awaken the evil spirits of a remote shrine.<br><br>
        You arrive at your destination. You immediately notice ${enemy.boss} in the distance, ${rivalpresence == true ? `with ${rival} at ${genderPronoun(enemy.sex,"object")} side,` : ``} watching the
        angry flames rising. ${rivalboost == true ? `${rival}${possessiveSuffix(rival)} eyes burn with hateful fire as if possessed!` : `You are in a dire hurry.`} "You again?!" ${enemy.boss} shouts, seeing you rush toward the flames. 
        "I was sure you would not have the time to bother me here, knowing what ${(finalboss.boss == enemy.boss) == true ? `other plans I have in motion` : `${finalboss.boss} is up to`}. Well, who doesn't need some exercise after a good old fashioned summoning?"<br><br>${laconicStatement()}.`}
    break;
    case "Cashed Out":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Each fighter may put a random defense token on a Frightened Gambler in their threat area.`,false,false,false],[`Search the stage deck for a Pit Boss card and choose one fighter to draw it. Shuffle the stage deck.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail} you locate the gambling den of the ${enemy.name}.<br><br>
        At the den, you poke around and eventually find your way to a set of double doors. Listening, you hear voices and burst in. ${enemy.boss} stands up from a private
        table to take you on. "A crime boss just can't take a break, huh?" ${genderPronoun(enemy.sex,"subject")} exclaims.`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you were able to locate the gambling den that is owned and operated by members of the ${enemy.name}. With so many of their members in one place, you knew it was the best bet to get more information. You decided to pay them a visit, break up their 
        operation and get some intel on the ${finalboss.boss}${possessiveSuffix(enemy.name)} plans.<br><br>
        When you arrived at the casino, you heard a commotion inside and - fearing you could lose the element of surprise - you busted in. Your hunch was right; ${enemy.boss} knew you were
        coming and was trying to clear the place out. "${rivalpresence == true ? `${rivalboost == true ? `Hold them off, ${rival}`: `Get the money, ${rival}`}` : `Get the money`}," ${genderPronoun(enemy.sex, "subject")} commanded, "${rivalboost == true ? `I'll get the money`: `I'll hold them off`}!"`}
        else {
        prologue = `${trail}, you didn't have much to work with. You manage to locate a gambling den that is owned and operated
        by members of the ${enemy.name}.  With so many of their members in one place, you knew it was the best bet to get information. You decided to pay them a visit.
        When you arrived at the casino, something seemed off.<br><br>
        Your hunch was right; ${enemy.boss} had been tipped. "Everybody, keep on playing!" ${genderPronoun(enemy.sex, "subject")} commanded, "${rivalpresence == true ? `Me and ${rival} will`: `I'll`} escort them out!"  `}
    break;
    
    case "Compromised":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Each fighter may search the stage deck for 1 copy of Calming Words and add it to their fighter play area. Shuffle the stage deck.`,false,false,false],[`Each fighter places 1 power on a different "Scared Staff" card.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") { prologue = `${trail}, you have arrived at the offices just in the nick of time. The ${enemy.name} is ushering their ${enemy.minions} into the building, ready to take 
        hostages. You managed to slip ahead of them. "There's no escape!" ${enemy.boss} shouts out. "Achieving our goals requires your cooperation,
        and you will abide by our demands!". As panic ensues around the offices, you make your move.<br><br>"There you are", ${enemy.boss} said with a mixture of amusement and
        annoyance. "Heard you were poking around. Let me show you the door before you get in over your heads."`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you made your way to an office building, but when you arrive, you knew it's too late. Sounds of violence can be heard inside the building, followed by screams inside and out.
        "Call the police!" several fleeing employees shout, but you know it's futile. The chances of police having the gear or training to handle this properly is beyond unlikely.<br><br>You rush into the
        building, heedless of all the warnings shouted at you. "Welcome!" You're greeted by ${rivalpresence == true ? `familiar faces` : `a familiar face` } that you hope to never see again. ${enemy.boss}, leader of the ${enemy.name} ${rivalpresence == true ? `is there with ${rival}` : enemy.threat}.
        "Did you come to join the other hostages?"`}
        else {
        prologue = `${stageindex == 0 ? `You are preparing for a hard-earned vacation, but just as you are about to take your leave from Citadel HQ` : `${trail} you have nothing.
        Not a thing. You are at Citadel HQ reviewing your data with the analysts. Suddenly` }, a klaxon starts blaring in the 
        facility.<br><br>
        An orderly rushes to you, and you follow him to find Agent Fletch in the control room. You think you can make out the grainy image of ${enemy.boss} on one screen. "Sir!" a technician says. 
        "I'm picking up multiple hostiles on the scanners!" "Scramble our defenses! It's the ${enemy.minions} of the ${enemy.name}!" Agent Fletch commands. "They must have a mole.." ${rivalpresence == true ? `
        Suddenly, a janitor takes off a cap and rips off a fake moustache. You look dumbfounded, as a door opens behind now exposed ${rival}, and ${enemy.boss} steps in. "Good job, my friend", 
        ${genderPronoun(enemy.sex,"subject")} says.`: `he draws his gun and shoots the janitor right where he stands! "I've suspected this for a long time."`}<br><br>${stageindex == 0 ? `So much for relaxation!` : `Never a dull day!`}`};
    break;
    
    case "Gone Ballistic":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`One fighter may move 3 spaces toward the nearest objective token.`,false,false,false],[`Search the stage deck for an additional objective card and put it into play. Shuffle the stage deck.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {
        prologue = `${trail}, you ascertain that an arms deal set up by the ${enemy.minions} of ${enemy.boss} is going on in an abandoned warehouse.<br><br>
        You move quickly to the scene to get a drop on the ${enemy.name}. On location, you see that the trade isn't done yet, and you can prevent the whole deal. You
        attack, the contact flees, and the ${enemy.minions} mill about, confused. ${enemy.boss} gets to the top of the situation quickly. "Get the guns",
        ${genderPronoun(enemy.sex, "subject")} orders. "And get the Gladiators!"`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you ascertain that an arms deal set up by the ${enemy.minions} of ${enemy.boss} is going on in an abandoned warehouse.<br><br>
        You move quickly to the scene to get a drop on the ${enemy.name}. "Boss!" a guard calls out. You hadn't seen him behind the crates nearby, but when you move to take cover
        behind them, he spotted you instantly. ${enemy.boss}, standing next to the contact for the trade, ${rivalpresence == true ? `${rival}, and they both turn to you in unison!` : `kills ${(Math.random() < 0.5 ? "the man" : "the woman")} without a second thought. "Get the guns",
        ${genderPronoun(enemy.sex, "subject")} orders. "And get those spies!"` }`}
        else {prologue = `${trail}, you believe that ${enemy.boss} may have been spotted at an abandoned warehouse ${rivalpresence == true ? `that's currently used as a base by ${rival},` : `which is as good lead as any at this point,`}
        so you decide your investigation continues there.<br><br>
        While you learn what you can about ${rivalpresence == true ? rival : `the warehouse`}, Agent Fletch turns the Citadel's resources to uncover ${enemy.boss}'s true intentions - turns out ${rivalpresence == true? `${rival} is` : `some goons are`} hosting an arms
        deal, and ${enemy.boss} is the main client!`}; 
    break;
    
    case "One Step Ahead":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Each fighter may search the enemy deck for a Minion card to discard. Shuffle the enemy deck.`,false,false,false],[`Each fighter must put their Objective card into the stage play area, and put the token in the corresponding space on the map.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail}, you have affirmed that the minions of ${enemy.boss} have been using the mountain path you suspected to conceal their movements, so that's where you head to lay an ambush.
        Climbing the mountain is arduous, but you finally settle on a point where to hunker down to spring your attack.<br><br>
        As you see the forces of the ${enemy.name} rush around the bend, you leap out of your hiding spot with the ${enemy.minions} in disarray!`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you have affirmed that ${enemy.minions} have been using a certain mountain path to conceal their movements, so that's where you head to lay an ambush.
        Climbing the mountain is arduous, but you finally settle on a point where to hunker down to spring your attack.<br><br>
        As you see the forces of the ${enemy.name} rush around the bend, you leap out of your hiding spot. ${enemy.boss} ${rivalpresence == true ? `, ${rival} at ${genderPronoun(enemy.sex,"possessive")} 
        side,` : `` } doesn't seem surprised by your efforts, however. 
        ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} only laughs at your attempts as ${genderPronoun(enemy.sex,"subject")} readies to strike back!`}
        else {prologue = `${stageindex = 0 ? `Some time after your last mission, you are on an outdoor fitness training regime on a steep cliff.` : `Completely clueless, you are roaming the countryside for
        any sight of ${finalboss.name} activity, and are searching through an old smugglers' mountain trail.`} Climbing the rough rock face is arduous, but you make good time, when suddenly 
        you are face to face with ${enemy.boss} and his band of goons. The ${enemy.name} is here!<br><br>
        ${enemy.boss} seems as surprised to see you as you are to see him, and shouts to ${genderPronoun(enemy.sex, "possessive")} minions: "Hold! We are not here to fight them!" Then 
        ${genderPronoun(enemy.sex, "subject")} turns to you and says: "We have no quarrel with you this time, ${defineAddressing(enemy)}. We are here to meet ${rivalpresence == true ? rival : `a contact`} for a negotiation, that is all. 
        Find the ${finalboss.name}, if you want to pick a fight.<br><br>You don't plan on letting these criminals get away. They'll have a fight in their hands whether they want it or not!`};
    break;
    
    case "Original Copy":
        setup = setup + ` Choose ${getRandomMinions(enemy, enemies)} deck as the minion.<br>` 
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Any fighter may put this card in their play area. <b>Feint:</b> Remove this card from the game to choose a copy of Vandal Serum attached to a card in the Cloning Area. Return the selected card to Serum Supply.`,false,false,false],[`Each fighter suffers 1 direct damage.  Then, if any fighter is on or adjacent to an objective space, remove this card from the game.`,true,true,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail")
        {prologue = `${trail}, you located the facility. You are surprised to find the lab not heavily guarded, so slipping in is not necessarily challenging, and you take the elevator down to the large lab.
        You patiently wait while a lounge version of ${loungeMusic()} plays over the cheap speakers.<br><br>Inside, however, you are glad to find just who
        you came for. "Just get what we came for," ${enemy.boss} commands. "We need as much as possible!" While the ${enemy.name} are distracted, you are able to sneak
        closer to inspect scattered documents nearby.`}
        else if (knowledge == "coldtrail") 
        {prologue = `${trail}, you made your way to the hidden facility. You defeated a few guards in your way and proceeded to take the elevator down to the large lab. You patiently wait while a lounge version of
        ${loungeMusic()} plays over the cheap speakers.<br><br>
        You finally reach a cavernous room filled with row upon row of glass containment tubes. Each tube has a motionless body in it; some of you recognized as opponents you'd faced before. ${rivalpresence == true ? `Suddenly, one of
        the tubes crashes open, and a figure can be seen within the steam, kneeling, faced away. It looks exactly like ${rival}!${rivalboost == true ? `It stands, slowly, powerfully built, moving with graceful precision. It is the ultimate clone, ${rival.toUpperCase()}-EX!` : ``} ` : ``}Standing at the far end of the room,
        you see ${enemy.boss} ${genderPronoun(enemy.sex,"reflexive")}. ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} looks at you and grins. ${upperCaseInitial(enemy.minions)} descend on you, emerging from the shadows.`}
        else 
        {prologue = `As you slowly regain consciousness, you notice an IV hooked up to your arm. Your strength has been completely drained and you are unable to even stand up.
        "Calm down there," a voice called. "${finalboss.boss} wants to run some tests to see if you're worth keeping alive."<br><br>
        You have no idea how long you have been the hostage to your captors. As your vision clears, you see the voice belongs to ${enemy.boss}, the
        notorious boss of ${enemy.name}, ${enemy.desc}. You also see that you are surrounded by sterile lab equipment and ominous test tubes occupied by shadowy figures${(rivalpresence == true && rivalboost == false) ? `, with ${rival} observing your vitals from a screen` : `` }. You
        suddenly feel a surge of strength return and yank out the IV. "Fine, let's do it the hard way!" ${rivalboost == true ? `Suddenly, one of the tubes crashes open, and a figure can be seen within the steam, kneeling, faced away.
        It stands, slowly, powerfully built, moving with graceful precision. It is the ultimate clone, ${rival.toUpperCase()}-EX!` : ``}`};
    break;
    
    case "Out of Time":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`The fighters may choose to flip one objective to its inactive side.`,false,false,false],[`${enemy.boss} gains 1 random defense token for each Remnant engaged with a fighter.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail}, you find yourself nearing one more ${evilPlace()}, hoping to find ${enemy.boss}. Animated corpses are digging their way out the ground all around you,
        a large altar dominating the scene where ${enemy.bosstitle} of the ${enemy.name} stands. "Stop this while you can, ${enemy.boss}!" you shout over the rising winds. The ${enemy.minions} and their boss
        all turn to you, surprised to see you there. "And you are the ones who are going to make me?" ${genderPronoun(enemy.sex,"subject")} asks, between amusement and annoyance."<br><br>
        ${laconicStatement()}.`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you find yourself nearing one more ${evilPlace()}, hoping to stop ${enemy.boss}. Animated corpses are rising out the ground all around you, a large altar dominating the scene.
        ${upperCaseInitial(enemy.bosstitle)} of the ${enemy.name} stands there, and turns ${genderPronoun(enemy.sex,"possessive")} gaze from the magic ${genderPronoun(enemy.sex,"subject")} is working on. "You cannot hope to
        contain this!" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} gestures at ${rivalpresence == true ? rival : `the walking dead`} and the ${enemy.minions} of the ${enemy.name}. "Seize them!"<br><br>${laconicStatement()}.`}
        else {prologue = `You come to your senses as undead hands are gripping you and guiding you upwards to an ominous altar on a large pedestal in front of you. What ${mysticalSynonym()} sorcery had kept you
        enthralled is weakening, and you put the zombie down. ${enemy.boss} looks down at you and shouts, as dark winds sting your skin and the very air around you smolders your throat and lungs:
        "For once you Citadel lackeys could try to be useful! ${rivalpresence == true ? (rivalboost == true ? `${rival}, standing there, turns and faces you unnaturally black eyes. "Get the gladiators, a` : `Get them up here, ${rival}! A`) : `Get up here and die, a` }nd this all will be over sooner!"<br><br>
        You still feel dizzy and uneasy and don't quite have your bearings at this ${evilPlace()}, but one thing you're certain of: you will not let ${enemy.boss} get away with this.`};
    break;
    
    case "Poison the Well":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Remove each copy of Vandal Addict from the stage deck and remove them from the game. Shuffle the stage deck.`,false,false,false],[`Each fighter searches the stage deck for 1 copy of Infected Rats and adds it to their Threat area. Shuffle the stage deck.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail}, you affirm that ${enemy.boss} has a secret sewer lair. From your intel, Citadel analysts pieced together a map of the tunnels which, surprisingly,
        seem quite accurate.<br><br>
        You enter the marked chamber, and find yourself in what used to be a water treatment facility that seems now being used as some sort of insane science experiment. "You?" comes a voice,
        echoing from somewhere else in the chamber. ${enemy.boss} step out of the shadows with the ${enemy.name} goons. "I thought you were after ${finalboss.boss}! Fast, get those pumps working!" Whatever they
        are used for, you believe that is one order that needs to be canceled.`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, but without much to go on, you checked in with a slippery informant. "${enemy.boss}?" the informant seemed surprised. 
        "You're going after ${genderPronoun(enemy.sex,"object")}? Well, everything I come up with leads to the sewers."<br><br> 
        Following the tip, you headed down in the sewers.  Unfortunately, it was a labyrinth${rivalpresence == true ? `` : `, and mutated rats harried you every turn`}. Suddenly, you are at what seems to be an insane science experiment.
        "You?" comes a voice, echoing from somewhere else in the chamber. "I had heard you were sticking your nose in my business. Well, your efforts have been wasted. We are almost done!" ${enemy.boss} ${(rivalpresence == true ? `and ${rival} setep` : `steps`)} out of the shadows, along with the ${enemy.name} goons.`}
        else {prologue = `You wake up, and the first thing you notice is the intense stench attacking your nostrils. You open your eyes, and as you focus, you can see ${enemy.boss} at a distance. You seem
        to be underground, in some kind of a crazy scientist setup, and ${enemy.minions} are moving canisters about big machinery.<br><br>"Oh, you're awake?!" ${enemy.boss} says, annoyed. "I was hoping you would
        not come to your senses before our bath would be ready for you!" You don't think this would be good for your skin, so you diplomatically refuse. The ${enemy.name}${possessiveSuffix(enemy.name)}
        goons don't seem to respond to kind words alone${rivalpresence == true ? `,nor does their foreman ${rival}` : ``}${rivalboost == true ? `, who looks to be pumped up on Vandal` : ``}.`};
    break;
    
    case "Right to Remain Silent":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Each fighter searches the stage deck for a copy of Sneaking, and puts it in their play area.`,false,false,false],[`Add one power to Recoverd Intel.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail}, you locate the kidnapped scouts along with ${enemy.boss} and ${genderPronoun(enemy.sex, "possessive")} cronies,
        the ${enemy.name}. Agent Fletch informs through your earpiece: "${finalboss.boss} cannot find out we're on to ${genderPronoun(finalboss.sex,"object")}, 
        but ${enemy.boss == finalboss.boss ? `soon ${genderPronoun(enemy.sex,"subject")} will`: `${enemy.boss} will surely relay anything useful forward` }. You must act fast, Global Gladiators!"<br><br>You were already on it!`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you find out the location of scouts of the Citadel who have been kidnapped by ${enemy.boss} and ${genderPronoun(enemy.sex, "possessive")} cronies,
        the ${enemy.name}. Agent Fletch informs through your earpiece: "${finalboss.boss} cannot find out we're on to ${genderPronoun(finalboss.sex,"object")}, 
        but ${enemy.boss} will surely relay anything useful forward. You must act fast, Global Gladiators!"<br><br>You arrive to the scene to see 
        ${rivalpresence == true ? `${rival} standing guard over the captives.` : `the enemies well prepared.`} This isn't going to be easy.`} 
        else {prologue = `"Finally awake?" That's the first thing you hear after the splash of stale water jolts you awake. 
        You have no idea how long you've been a hostage of the ${enemy.name}, ${enemy.desc} — but you'd guess it's been at least a few days.<br><br>
        ${stageindex == 0 ? `Your simple recon mission went south, and now y` : `Y`}ou've been enduring  their tortures as they've tried to get everything they could out of you. 
        You've held out for now but don't know how long you'll be able to keep it up. ${enemy.boss} ${enemy.threat} as ${genderPronoun(enemy.sex, "subject")} stares at you down. "I'll give you this one 
        chance to come clean before we start our procedures again." Your silence is deafening as you stare at the floor. "Very well," ${enemy.boss} sneers. "I won't be gone for too long,
        ${defineAddressing(enemy)}. Don't get comfortable."<br><br>
        ${upperCaseInitial(genderPronoun(enemy.sex, "subject"))} exits, and ${rivalpresence == true ? `${rival} stays to guard over you.` : `as soon as the door closes behind ${genderPronoun(enemy.sex, "object")}, you begin working at your bonds.`}`};
    
    break;
    case "Rude Awakening":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Flip all objectives to their inactive side.`,false,false,false],[`Each fighter places 1 damage on the Stage Rules card.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail}, you finally find yourself at your destination, another ${evilPlace()}. You see a bunch of people all of them shambling about, all of them appearing broken and decayed.<br><br>
        You immediately notice ${enemy.boss}, directing a cabal of necromancers! "No! You shouldn't be here!" ${genderPronoun(enemy.sex,"subject")} exclaims. "Not yet, in any case.. no matter, soon you will join the horde!"`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you finally find yourself at your destination, another ${evilPlace()}. You see a veritable sea of people, all of them shambling about, all of them appearing broken and decayed.<br><br>
        You immediately notice ${enemy.boss}, directing a cabal of necromancers${rivalpresence == true ? `, with ${rival} standing guard, ` : ``}!
        ${rivalpresence == true ? ` "Stop those Gladiators! Just a little more time, and we will both get what we came for," the leader of the ${enemy.name} spits.` : ` "Even you will fall to the power of death,
        ${defineAddressing(enemy)}!" ${genderPronoun(enemy.sex,"subject")} shouts, and the coven is surrounded by ${mysticalSynonym()} energy. You see even more  zombies climb out of the ground at their feet.`}`}
        else {prologue = `${trail}, you find yourself at your destination, ${evilPlace()}. You see a veritable sea of people, all of them shambling about, all of them appearing broken and decayed.<br><br>
        As you look over the zombies around you, you notice in the distance ${enemy.boss}, ${rivalpresence == true ? `with ${rival} standing guard, ` : ``}directing a cabal of necromancers!
        ${rivalpresence == true ? `"Stop those Gladiators! Just a little more time, and we will both get what we came for," the leader of the ${enemy.name} spits.` : `"You will never have time to stop me and
        ${finalboss.boss} both!" ${genderPronoun(enemy.sex, "subject")} shouts!`}${rivalboost == true ? ` ${rival}, looking like a corpse, hisses and lunges at you!` : ``}`}
    break;
    
    case "Running Wild":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`<b>Feint:</b> Roll 3 enemy dice; for each different result, remove 1 power from "The Final Key".`,true,false,false],[`Each Hero places 3 random defense tokens on the copy of "Hunt for the Idols" in their fighter play area. Each time a Hero searches, these defense tokens block successes and are discarded as normal.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail}, you find the ${enemy.minions} of ${enemy.name} in the forest, near a ruined shrine. ${enemy.boss} shouts to ${genderPronoun(enemy.sex,"possessive")}
        goons: "Search, you fools, search! It cannot take this long!"<br><br>${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} then notices your approach and further instructs ${genderPronoun(enemy.sex,"possessive")} goons: 
        "Just find them! I can hold these troublemakers!"<br><br>You inform ${enemy.boss} that whatever they are after, it probably belongs in a museum.`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you find the ${enemy.minions} of ${enemy.name} have been seen in the forest, near a ruined shrine.<br><br>With help from the locals you have no trouble finding the general
        area where the ${enemy.name}${possessiveSuffix(enemy.name)} searches are happening, but turns out they have been scouring the woods for days already. When you reach them,
        you find ${enemy.boss} shouting to ${genderPronoun(enemy.sex,"possessive")} goons${rivalpresence == true ? ` and ${rival}`:``}: "The idols are near, I can feel it my bones!" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} then notices your
        approach and ${enemy.threat}.`}
        else {prologue = `${trail}, you find the ${enemy.minions} of ${enemy.name} have been seen in the forest, near a ruined shrine. With help from the locals you have no trouble finding the general
        area where the ${enemy.name}${possessiveSuffix(enemy.name)} searches are happening, but turns out they have been scouring the woods for weeks already, and are quite prepared.<br><br>
        When you reach them, you find ${enemy.boss} shouting to ${genderPronoun(enemy.sex,"possessive")} goons${rivalpresence == true ? ` and ${rival}`:``}: "The idols are near, I can feel it my bones!"
        ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} then notices your approach and ${enemy.threat}.`}
    break;

    case "Steel Memories":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`One fighter may move 3 spaces toward the nearest objective.`,false,false,false],[`Each fighter must <b>Recruit</b>.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail}, you accompany a squad of Citadel soldiers as they storm the ${enemy.name}${possessiveSuffix(enemy.name)} secret base. ${enemy.name} soldiers
        fall before you, and you make your way through the maze-like halls until you finally reach an elevator.<br><br>You wait patiently, while a lounge version of ${loungeMusic()} plays over the cheap speakers.
        When you arrive, ${enemy.boss} seems surprised. "I'm not surprised to see you here," ${genderPronoun(enemy.sex, "subject")} claims, contrary to your suspicions of having the element of surprise. "I have a message for you
        from ${finalboss.boss}, ${defineAddressing(enemy)}: nobody will leave this room alive!" ${laconicStatement()}.`
        }
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you managed to track the ${enemy.name == "Kingdom" ? "Kingdom in the middle of its previous practice" : (enemy.name) + " in their lair, in the same practices as the Kingdom"}: testing out new recruits in a savage melee where only the strong survive.<br><br>
        You tried to go undercover, posing as recruits for yourselves. But ${enemy.boss} - knowing your plan from the past - saw through your ploy and threw you into ${genderPronoun(enemy.sex,"possessive")}
        "pit". You suddenly became the final exam for ${genderPronoun(enemy.sex,"possessive")} would-be recruits...`
        }
        else {prologue = `You wake up in a pitch black room and turn around, hoping to find some sort of reference to where exactly you are, but not fully recovered. All you see is the ever-encroaching blackness and
        the deafening silence surrounding you.<br><br>
        And then, the lights in the room snap on, almost blinding you with their intensity. You blink, and see standing before you the ${enemy.bosstitle} leader of the ${enemy.name}:
        ${enemy.boss}. "What better to practice on than the Citadel's finest?" ${genderPronoun(enemy.sex,"subject")} wonders, smirking.${rivalpresence == true ? `"It is time you prove your worth, ${rival}!" ${enemy.boss} exclaims.`: ``}`
        };
    break;
    
    case "Sudden Death":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Put one random defense toke on each copy of "A New Challenger".`,false,false,false],[`The active objective token nearest ${enemy.boss} advances 4 spaces toward ${enemy.boss} and attacks.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {
        prologue = `${trail}, you found that ${enemy.name == "Kingdom" ? "the Kingdom is ideed back to its previous practice: " : `the ${enemy.name} have indeed adopted the practices pioneered by the Kingdom: `}
        testing out new recruits in a savage melee where only the strong survive.<br><br>
        You infiltrate yet another underground fight club focused on bringing the most ruthless fighters out in a fight to death. You couldn't let that happen, and are determined shut
        down the ${enemy.name}${possessiveSuffix(enemy.name)} efforts first hand!`
        }
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you have surmised that the ${enemy.bosstitle} ${enemy.boss} has been openly recruiting soldiers into the ${enemy.name}. As you 
        pushed the matter further, you found that ${enemy.name == "The Kingdom" ? "the Kingdom was back to its previous practice: " : (enemy.name) + " has adopted the same practices as the Kingdom: "}
        testing out new recruits in a savage melee where only the strong survive.<br><br>
        You infiltrate yet another underground fight club focused on bringing the most ruthless fighters out in a fight to death. You couldn't let that happen, and are determined shut down the
        ${enemy.name}${possessiveSuffix(enemy.name)} efforts first hand!`
        }
        else {
        prologue = `Hands tied behind your back, you are led by ${enemy.boss} and ${minion} into an oddly-placed urban clearing. The out-of-place streets are
        hosting several fighters, each of them sparring in deadly martial arts. "You're not worthy to walk on this ground," ${minion} growls, glaring at you with a deep-seated hatred.
        "And so", ${enemy.boss} interjects. "We will allow you the chance to prove your worth. ${finalboss.boss == enemy.boss? `I have developed a great interest in you.
        I would be pleased if you'd demonstrate it to my doubting minion.` : `${finalboss.boss} has taken great interest in you. Show us why that is.`}"<br><br>"This is unnecessary," ${minion} says quietly to ${enemy.boss}. "You play games with the trust of the ${finalboss.name == enemy.name ? "Master" : finalboss.name}."
        ${enemy.boss} loosens your bonds, ignoring ${minion}${possessiveSuffix(minion)} words. You grab your wrists as they are free, rubbing the pain away, and watch as the other fighters turn toward ${enemy.boss},
        preparing for what you're assuming will be a fight to the death. The other fighters show no fear, their eyes looking only for glory${rivalboost == true ? `, and ${rival} looking especially eager to beat you to a pulp` : ``}.`
        }
    break;
    
    case "Supply & Demand":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Any fighter may put this card in their play area. <b>Feint:</b> Remove this card from the game to choose one enemy to drop an objectve token it is carrying.`,false,false,false],[`${enemy.boss} gains 1 random defense token. Each fighter is dealt 1 direct damage.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail}, you are on to a black market trade conducted by the ${enemy.name}.<br><br>
        You have approached the site stealthily, and observe the ongoing trade. Standing nearby, the ${enemy.bosstitle} ${enemy.boss} watches over the activity. During their work, one of the
        soldiers drops his crate, a large amount of illegal drugs spilling out onto the concrete loading dock. You hear ${enemy.boss} roar in rage at the soldier's
        clumsiness, and use the commotion as a cover for your attack!`
        }
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you are on to a black market trade is conducted by the ${enemy.name}.<br><br>
        You have approached the site stealthily, and are preparing your attack. Standing nearby, the ${enemy.bosstitle} ${enemy.boss} watches over the activity. During their work, one of the
        soldiers drops his crate, a large amount of illegal drugs spilling out onto the concrete loading dock. You duck behind cover, and hear ${enemy.boss} roar in rage at the soldier's
        clumsiness. ${rivalpresence == true ? `${rival} calms ${genderPronoun(enemy.sex,"object")}, saving the unlucky soldier: "Somebody's back there!"`: `Yet it only takes a few exchanged words before
        you are given up. "Show yourself, ${defineAddressing(enemy)}!" ${enemy.boss} calls. "And face your opponent head-on!" The ensuing burst of gunfire convinces you otherwise.`}`
        }
        else {
        prologue = `${trail}, you happen upon a black market trade conducted by ${enemy.name}.<br><br>
        You have approached the site stealthily, and are just about to attack. Standing nearby, the ${enemy.bosstitle} ${enemy.boss} watches over the activity. ${rivalpresence == true ? `During their work,
        one of the soldiers spots you and drops his crate, a large amount of illegal drugs spilling out onto the concrete loading dock. You duck behind cover, but ${rivalboost == true ? `out of nowhere
        ${rival} leaps from the shadows and delivers a powerful strike square to your face.` : `${rival} calms ${genderPronoun(enemy.sex,"object")}, saving the unlucky soldier: "Somebody's back there!"`}` : `Suddenly,
        the soldiers carrying the goods drop their crates where they stand, illegal drugs spilling out! "Show yourself, ${defineAddressing(enemy)}!" ${enemy.boss} calls. You position is rained on by
        torrents of gunfire. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} shouts. "${gloat[1]}"`}`
        };
    break;
    
    case "The Ceremony":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Flip 2 objective tokens to their inactive side.`,false,false,false],[`Each fighter must either discard a card at random or place 1 power on "Oni's Vessel".`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {prologue = `${trail}, you arrive at one more ${evilPlace()}. You wonder to yourself how many of these are still hidden around the country?<br><br>
        Once there, you find ${enemy.minions} busy arranging the unholy paraphernalia, with ${enemy.boss} in the midst of it all. "Get the interlopers!"
        ${genderPronoun(enemy.sex,"subject")} shouts. "I don't know if this will work, but it's worth the effort to try!"`
        }
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you have found out that ${enemy.boss} has unearthed tremendous supernatural power! You can see the sky turning rapidly to a reddish hue
        as you close in on your destination.<br><br>
        You arrive, and barge toward the building in the center of it all. "${gloat[0]}!" ${enemy.boss}
        shouts${rivalpresence == true ? `, with ${rival} at ${genderPronoun(enemy.sex, "possessive")} side` : ""}. "${gloat[1]} The ceremony is already underway!"<br><br>${laconicStatement()}.`}
        else {prologue = `${trail}, you realize you do not have the luxury of chasing your original goals right now.
        According to the intel ${enemy.boss} has unearthed tremendous supernatural power! You can see the sky funneling down with an intense, blood-red stream of power descending
        upon your destination.<br><br>
        You arrive, with Citadel soldiers bathed in demonic light clearing the grounds before you, and barge toward the building in the center of it all. 
        ${rivalpresence == true ? `You find ${rival} standing in the aura, ${rivalboost == true ? `bathed with a portion of the descending energy` : `amazed by the display of energy`}.` : ``}
        "You are too late, ${defineAddressing(enemy)}!" ${enemy.boss} shouts, pulsating with power. "The ceremony is already underway!" ${laconicStatement()}.`
        }
    break;
    
    case "Under Destruction":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`<b>Exhaust:</b> Move 1 power from a Time Bomb card to this card. Then, if there's 5 power on this card, remove it from the game.`,true,false,false],[`Each fighter chooses a different objective and places 1 power on the chosen objective.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge == "hottrail") {
        prologue = `${trail}, you find out the site that ${enemy.name} has targeted. According to the intel, the building being constructed is owned by the ${competitor.name} through shell corporations. You don't really mind ${competitor.desc} taking such a loss,
        but why is the ${enemy.name} so interested in this place?<br><br>
        You arrive at the scene, where ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} ${enemy.minions} are busy setting the explosives. "Faster, ${randFrom(enemy.minionnames)}," ${enemy.boss}
        shouts. "We need to be ready before those pesky.." Then ${genderPronoun(enemy.sex,"subject")} sees you, and ${genderPronoun(enemy.sex,"possessive")} face darkens.`}
        else if (knowledge == "coldtrail") {
        prologue = `${trail}, you find out that the ${enemy.name} has been very busy setting up explosives to bring a construction site down. Unfortunately, you may have arrived too late..<br><br>
        "Arm the bombs and let's get out of here," a voice commands from behind a plastic sheet. When the sheet is thrown aside, ${enemy.boss} ${rivalpresence == true ? `and ${rival} step` : `steps`} into view. 
        ${enemy.boss}${possessiveSuffix(enemy.boss)} eyes immediately dart from the placed explosives. Without hesitation, ${genderPronoun(enemy.sex,"subject")} attacks!${rivalboost == true ? ` "Leave
        something for me!" ${rival} shouts.` : ``}`}
        else {
        prologue = `You open your eyes and find yourself in.. an unfinished construction site? Suddenly, ${enemy.boss} steps out from the shadows. "Welcome, ${enemy.addressing}! 
        Nice of you to join us!" You note that ${enemy.minions} are suddenly blocking every exit, except for the one ${enemy.boss} is guarding. "The whole place is rigged with
        explosives, ${rivalpresence == true ? `and some would even pay to watch you die!" At that, ${rival} steps into view. ${rivalboost == true ? `"But I'm a hands-on kind of person," ${rival} adds,
        and moves at you.` : ``}` : `and I will gladly expend some foot soldiers to get to watch you being.. demolished!"`}<br><br>
        No matter if this sounds contrived, you have no choice but to fight your way out - and fast!`};
    break;
    default: 
    prologue = "The stage has no stage intro defined.<br>"
    }
    
    return {prologue: prologue, setup: setup, winepilogue: winepilogue, loseepilogue: loseepilogue}
}

function textMaker(story, alliesandrivals, heronames, enemies) {

let cardtext
let cardtexts = []
let winepilogue = "Victory text"
let loseepilogue = "Defeat text"
let pregameprologue = preGamePrologue(story[7].stage,story[7].enemy)

for (i = 0; i < story.length-2; i++) {
    cardtext = createPrologue(i, story, alliesandrivals, heronames, enemies, pregameprologue[1]);
    cardtexts.push(cardtext)
}

for (i = 7; i < story.length; i++) {
    cardtext = createFinale(i, story, alliesandrivals, heronames, enemies, pregameprologue[0]);
    cardtexts.push(cardtext)
}


return cardtexts
    
}

function createFinale(stageindex, story, alliesandrivals, heronames, enemies, pregameprologue) {
    let finalboss = story[7].enemy
    let finalstage = story[7].stage
    let enemy = story[stageindex].enemy
    let stage = story[stageindex].stage
    let rival = allyNamer(alliesandrivals, enemy, heronames)
    let rival2 = allyNamer(alliesandrivals, enemy, heronames)
    let competitor = enemies.length > 0 ? enemies[Math.floor(Math.random()*enemies.length)] : {name: `enemies of the ${enemy.name}`, des: "an ally of the Kingdom"}
    let knowledge = defineKnowledge(stageindex, story)
    let masterplan = pregameprologue
    let minion = randFrom(enemy.minionnames)
    let trail = randFrom(["Based on current intel","Chasing the clues","Following your leads", "In pursuit of clues", "After a little more intel-gathering", "Following this lead", "As you investigated further", "After searching for more intel","Following the intel you had","After searching for more information"]);
    let instructions
    let rivalpresence
    let rivalboost
    let setup = `<b>${stage.name}: ${enemy.name} ${enemy.name == "Kingdom" ? `(${enemy.boss})` : "" }</b><br>`
    let win = determineNextStage(stageindex, story, 1)
    let lose = determineNextStage(stageindex, story, 0)
    let winepilogue = finalResult(masterplan,enemy,rival,1) + "<br><br>" + `${finalboss.boss != enemy.boss ? `You could not stop the ${finalboss.boss}, but your efforts were not in vain, as a threat as serious was neutralized. ` : ``}The fighters win this story.`
    let loseepilogue = finalResult(masterplan,enemy,rival,0) + "<br><br>" + `The fighters lose this story.`
    let gloat = gloatingList(enemy)

    switch (stage.name) {
    case "Ashes of the Eternal":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Any fighter may put this card in their play area. <b>Feint:</b> Remove this card from the game to discard 1 fire token from the map.`,false,false,false],[`The fighter places 1 fire token in the space nearest to them.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "actsofterror") {
        prologue = `${trail}, you have learned that ${enemy.boss}, just to show that Citadel is powerless before the ${enemy.name}, has trapped the ${randFrom([`police chief's`,`President's`,`Colonel's`])} ${randFrom([`daughter`,`son`])} and all of their wedding guests inside the locale of the festivities - and unleashed a supernatural fire on them!<br><br>
        "${gloat[0]}" ${enemy.boss} says${(rivalpresence == true && rivalboost == false) ? `, with ${rival} at ${genderPronoun(enemy.sex,"object")} side,` : ``}. "${gloat[1]}" You have to put out the fires and save the people inside - or the city will see the ${enemy.name} are in total control, and the Citadel cannot save them! And if you cannot, who can?
        ${rivalboost == true ? ` ${rival}, eyes burning with the unnatural fire, rushes to intercept you!` :``}`}
        else if (knowledge != "clueless" && masterplan == "personalpower") {
        prologue = `${trail}, it is clear ${enemy.desc} of ${enemy.name} is invoking an evil entity at a remote ${evilPlace()} to receive unfathomable power. You have decided to head there.<br><br>
        Almost too late! When you arrive, ritual fires have been set, and the flames are getting higher! ${enemy.boss}${possessiveSuffix(enemy.boss)} minions${(rivalpresence == true  && rivalboost == false) ? ` and ${rival}` : ``} are working the ritual, while the 
        ${enemy.bosstitle} ${genderPronoun(enemy.sex,"reflexive")} draws in the ${mysticalSynonym()} power. You call out to ${genderPronoun(enemy.sex,"object")}: "Stop it now!" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} looks at you. "${gloat[0]}" ${enemy.boss} answers. "${gloat[1]}"<br><br>
        You take that as a no, and begin to undo the ritual!${rivalboost == true ? ` ${rival}, as if possessed by the fiery demon force, rushes to intercept you!` :``}`}
        else {prologue = `${changeOfPlans(trail,finalboss,enemy,stage)}<br><br>
        You arrive at your destination. You immediately notice ${enemy.boss} in the distance, ${rivalpresence == true ? `with ${rival} at ${genderPronoun(enemy.sex,"object")} side,` : ``} watching the
        angry flames rising. ${rivalboost == true ? `${rival}${possessiveSuffix(rival)} eyes burn with hateful fire!` : `You are in a dire hurry.`} "${gloat[0]}" ${enemy.boss} shouts, seeing you rush toward the flames. 
        "${gloat[1]}`}
    break;
    
    case "Cashed Out":
    instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Each fighter may put a random defense token on a Frightened Gambler in their threat area.`,false,false,false],[`Search the stage deck for a Pit Boss card and choose one fighter to draw it. Shuffle the stage deck.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "illegalgains") {
        prologue = `${trail}, you finally figure out the plan ${enemy.boss} has. ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} operates an extremely lucrative network casinoes and nightclubs that the ${enemy.name}
        uses as a front for criminal activities of all types, and funnels money to the organization's plans of world domination. It is completely shielded for any investigations by the traditional authorities, but
        as Citadel agents, you are not as restrained.<br><br>
        You arrive at the headquarters, where your surroundings speak volumes about the vast wealth channeled into the ${enemy.name}${possessiveSuffix(enemy.name)} operations. ${enemy.boss} ${genderPronoun(enemy.sex,"reflexive")}
        comes to greet you. "Give it up, ${enemy.boss}!" you challenge ${genderPronoun(enemy.sex,"object")}. "${gloat[0]} the ${enemy.bosstitle} answers, and continues: "${gloat[1]}"`}
        else if (knowledge != "clueless" && masterplan == "actsofterror") {
        prologue = `${trail}, you finally figure out the plan ${enemy.boss} has. ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} operates an extremely lucrative network casinoes and nightclubs that the ${enemy.name}
        uses as a front for criminal activities of all types, and this wretched hive of scum and villainy is on its way to corrupt the city to its core. You don't believe for a second the city officials would make a move against the ${enemy.name} now.<br><br>
        You arrive at the hearquarters, where your surroundings speak volumes about the vast wealth channeled into the ${enemy.name}${possessiveSuffix(enemy.name)} operations. ${enemy.boss} ${genderPronoun(enemy.sex,"reflexive")}
        comes to greet you. "Give it up, ${enemy.boss}!" you challenge ${genderPronoun(enemy.sex,"object")}. "And why would I? If you have a gun, you can rob a casino. But if you have a casino, you can rob everyone," 
        ${enemy.boss} answers, beaming.`}
        else {
        prologue = `${changeOfPlans(trail,finalboss,enemy,stage)}<br><br>
        You manage to locate a gambling den that is owned and operated by members of the ${enemy.name} You decided to pay them a visit. When you arrived at the casino, something seemed off.
        Your hunch was right; ${enemy.boss} had been tipped. "Everybody, keep on playing!" ${genderPronoun(enemy.sex, "subject")} commanded, "${rivalpresence == true ? `Me and ${rival} will`: `I'll`} escort them out!"  `}
    break;
    
    case "Compromised":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Each fighter may search the stage deck for 1 copy of Calming Words and add it to their fighter play area. Shuffle the stage deck.`,false,false,false],[`Each fighter places 1 power on a different "Scared Staff" card.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "actsofterror") {
        prologue = `${trail}, you have determined that the ${enemy.name} will take hostage the whole ${randFrom(["White House","city hall","police headquarters","Pentagon"])} in a show of power. 
        You have arrived at the location. Sounds of violence can be heard inside the building, followed by screams inside and out.
        "Call the police!" several fleeing employees shout, but you know it's futile. The chances of police having the gear or training to handle this properly is beyond unlikely.<br><br>
        You get past the ${enemy.minions} on guard, and face ${enemy.boss} ${genderPronoun(enemy.sex,"reflexive")}. "This ends here, ${enemy.boss}! I am not here to negotiate!" you call out. "${gloat[0]}" 
        ${genderPronoun(enemy.sex,"subject")} answers, "${gloat[1]}"`}
        else if (knowledge != "clueless" && masterplan == "kidnapping") {
        prologue = `${trail}, turns out the ${enemy.name} have hidden your rescue target in plain sight, a public office building. 
        The chances of police having the gear or training to handle this properly is beyond unlikely. So you move in on your own.<br><br>
        You get past the ${enemy.minions} on guard, and face ${enemy.boss} ${genderPronoun(enemy.sex,"reflexive")}. "This ends here, ${enemy.boss}! I am not here to negotiate!" you call out. "${gloat[0]}" 
        ${genderPronoun(enemy.sex,"subject")} answers, "${gloat[1]}"`}
        else {
        prologue = `${changeOfPlans(trail,finalboss,enemy,stage)}<br><br>
        You make your way to the location, but when you arrive, you knew it's too late. Sounds of violence can be heard inside the building, followed by screams inside and out.
        "Call the police!" several fleeing employees shout, but you know it's futile. The chances of police having the gear or training to handle this properly is beyond unlikely.<br><br>You rush into the
        building, heedless of all the warnings shouted at you. "${gloat[0]}" You're greeted by ${rivalpresence == true ? `familiar faces` : `a familiar face` } that you hoped you might have seen last of. ${enemy.boss}, leader of the ${enemy.name} ${rivalpresence == true ? `is there with ${rival}` : enemy.threat}.
        "${gloat[1]}"`};
    break;
    
    case "Gone Ballistic":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`One fighter may move 3 spaces toward the nearest objective token.`,false,false,false],[`Search the stage deck for an additional objective card and put it into play. Shuffle the stage deck.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "strengtheningforces") {
        prologue = `${trail}, you have found out that ${enemy.boss} is planning on buying enough firepower for ${enemy.name} goons to completely take over the city by force of might. The location is known, but Agent Fletch does
        not think the police is fast enough - or well enough trained - to take part in an operation against an opponent this dangerous.<br><br>
        You arrive at the warehouse and find ${enemy.boss} along with ${genderPronoun(enemy.sex,"possessive")} ${enemy.minions}. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} says to you. "${gloat[1]}"
        ${enemy.boss} ends ${genderPronoun(enemy.sex,"possessive")} gloating.
        You have to stop the ${enemy.name} here and now, or the city will not survive.`
        }
        else if (knowledge != "clueless" && masterplan == "illegalgains") {
        prologue = `${trail}, you have found out that the ${enemy.name} is funding their operation by conducting an immense international arms deal in an abandoned warehouse. Agent Fletch does not think the police is fast
        enough - or well enough trained - to take part in an operation against an opponent this dangerous.<br><br>
        You arrive at the warehouse and find ${enemy.boss} surrounded by ${genderPronoun(enemy.sex,"possessive")} goons preparing for the deal. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} says. "${gloat[1]}
        Grab a gun, ${randFrom(enemy.minionnames)}! Let's give them hell!"
        You have to stop the ${enemy.boss} here and now, or their reach and power will grow exponentially.`
        }
        else {prologue = `${changeOfPlans(trail,finalboss,enemy,stage)}<br><br>
        You believe that ${enemy.boss} may have been spotted at an abandoned warehouse ${rivalpresence == true ? `that's currently used as a base by ${rival},` : `which is as good lead as any at this point,`}
        so you decide your investigation continues there.<br><br>
        Agent Fletch does not think the police is fast enough - or well enough trained - to take part in an operation against an opponent this dangerous, so you move in on your own.`}; 
    break;
    
    case "One Step Ahead":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Each fighter may search the deck for a Minion card to discard. Shuffle the enemy deck.`,false,false,false],[`Each fighter must put their Objective card into the stage play area, and put the token in the corresponding space on the map.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "kidnapping") {
        prologue = `${trail}, you have confirmed that the minions of ${enemy.boss} have your rescue mark holed up in a remote mountain cave. Going by helicopter would surely
        alert the ${enemy.name}, so you must approach by foot. You start the arduous climb, and after a while you find ${enemy.boss} blocking your way.<br><br>
        "I didn't believe you had it in you to get this far! ${gloat[0]}" shouts ${enemy.boss}, and turns slightly. "${randFrom(enemy.minionnames)}! Just get to the cave and kill ${randFrom(["him","her"])}!" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} turns back to you
        and continues: "${gloat[1]}"`}
        else if (knowledge != "clueless" && masterplan == "personalpower") {
        prologue = `${trail}, you have confirmed that the minions of ${enemy.boss} have located a mountain cave that, under specific star conjunction, will bless a person of proper disposition and correct rites with ${mysticalSynonym()} powers. Going by helicopter would surely
        alert the ${enemy.name}, so you must approach by foot. You start the arduous climb, and after a while you find ${enemy.boss} blocking your way.<br><br>
        "${randFrom(enemy.minionnames)}! Take the rest of the ${enemy.minions} and prepare the cave! I will come there when the stars are right!" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} turns to you. "${gloat[0]}" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} says eyeing you. "${gloat[1]}"`}
        else {prologue = `${changeOfPlans(trail,finalboss,enemy,stage)}<br><br>
        You have confirmed that the minions of ${enemy.boss} are operating near a certain mountain cave. Going by helicopter would surely
        alert the ${enemy.name}, so you must approach by foot. You start the arduous climb, and after a while you find ${enemy.boss} blocking your way.<br><br>
        "${randFrom(enemy.minionnames)}! Take the rest of the ${enemy.minions} and retreat to the cave!" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} turns to you. "I can
        handle you as it is, ${defineAddressing(enemy)}"`}
    break;
    
    case "Original Copy":
        setup = setup + ` Choose ${getRandomMinions(enemy, enemies)} deck as the minion.<br>` 
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Any fighter may put this card in their play area. <b>Feint:</b> Remove this card from the game to choose a copy of Vandal Serum attached to a card in the Cloning Area. Return the selected card to Serum Supply.`,false,false,false],[`Each fighter suffers 1 direct damage.  Then, if any fighter is on or adjacent to an objective space, remove this card from the game.`,true,true,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "strengtheningforces")
        {prologue = `${trail}, you eventually find the exact location of the secret laboratory where ${enemy.boss} is growing ${genderPronoun(enemy.sex,"possessive")} army, and make your way to the hidden facility.
        You fight with the guards until you find your way to an elevator, and proceed down to the large lab. You patiently wait while a lounge version of
        ${loungeMusic()} plays over the cheap speakers.<br><br>
        You finally reach a cavernous room filled with rows upon rows of glass containment tubes. Each tube has a motionless body in it; some of you recognized as opponents you'd faced before. There must be hundreds of clones in here! ${rivalpresence == true ? `Suddenly, one of
        the tubes crashes open, and a figure can be seen within the steam, kneeling, faced away. It looks exactly like ${rival}! ` : ``}Standing at the far end of the room,
        you see ${enemy.boss} ${genderPronoun(enemy.sex,"reflexive")}. ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} looks at you and grins. If you cannot stop ${enemy.boss} right here, ${genderPronoun(enemy.sex,"possessive")} army will be big enough to completely take over the city!`}
        else if (knowledge != "clueless" && masterplan == "personalpower") 
        {prologue = `${trail}, you eventually find the secret laboratory where ${enemy.boss} is is about to be reborn with unprecedented power imbued by a modified strain of ${randFrom(["Dynasty Cells","Vandal Serum","Dark Matter"])}. You make your way to the hidden facility.
        You fight with the guards until you find your way to an elevator, and proceed down to the large lab. You patiently wait while a lounge version of
        ${loungeMusic()} plays over the cheap speakers.<br><br>
        You finally reach a cavernous room filled with glass containment tubes. You see ${randFrom(enemy.minionnames)}, who stands near ${rivalpresence == true ? `two large incubation tubes` : `a large incubation tube`}. "I'm sure our ${enemy.bosstitle}
        grows tired of the confinement," the goon says, and presses a few buttons on the side of ${rivalpresence == true ? `one` : `the`} tube, and you watch as ${rivalpresence == true ? `they slide` : `it slides`} open. Out steps ${enemy.boss}, surrounded by an aura as dark and ominous
        as ${genderPronoun(enemy.sex,"possessive")} very reputation. ${upperCaseInitial(genderPronoun(enemy.sex,"possessive"))} eyes glow with a deep red energy, and ${genderPronoun(enemy.sex,"subject")} turns those burning orbs on you as ${genderPronoun(enemy.sex,"subject")} clenches ${genderPronoun(enemy.sex,"possessive")} fists.
        ${rivalpresence == true ? `Within the other tube, a figure can be seen within the steam, kneeling. ${rivalboost == true ? `It stands, slowly, powerfully built, moving with graceful precision. It is the ultimate clone, ${rival.toUpperCase()}-EX!` : `It looks exactly like ${rival}!`}` : ``}<br><br>
        You know this, the final confrontation, won't be easy!`}
        else 
        {prologue = `As you slowly regain consciousness, you notice an IV hooked up to your arm. Your strength has been completely drained and you are unable to even stand up.
        "${gloat[0]}," a voice called. "${gloat[1]}"<br><br>
        Your simple recon mission had gone south, and now you have no idea how long you have been the hostage to your captors. As your vision clears, you see the voice belongs to ${enemy.boss}, the
        notorious boss of ${enemy.name}, ${enemy.desc}. You also see that you are surrounded by sterile lab equipment and ominous test tubes occupied by shadowy figures${rivalpresence == true && rivalboost == false ? `, with ${rival} observing your vitals from a screen` : `` }. You
        suddenly feel a surge of strength return and yank out the IV. "Fine, let's do it the hard way!" ${rivalpresence == true && rivalboost == true ? `Suddenly, one of the tubes crashes open, and a figure can be seen within the steam, kneeling, faced away.
        It stands, slowly, powerfully built, moving with graceful precision. It is the ultimate clone, ${rival.toUpperCase()}-EX!` : ``}`};
    break;
    
    case "Out of Time":
    instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`The fighters may choose to flip one objective to its inactive side.`,false,false,false],[`${enemy.boss} gains 1 random defense token for each Remnant engaged with a fighter.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "strengtheningforces") {
        prologue = `${trail}, you have located the ${evilPlace() } where ${enemy.boss} will enact ${genderPronoun(enemy.sex,"possessive")} masterplan. Citadel agents escort you to the remote location. The
        world around you is nothing like the one you have lived in all of your life. ${enemy.boss} has apparently shifted the place to another dimension, one where the dark winds sting your skin and the
        very air around you smolders your throat and lungs.  The sky is a boiling, writhing mass of clouds, each black as coal but glowing with an intense, blood-red heat. If there is a hell, this may as well be it.<br><br>
        You see ${enemy.boss}, not far away, continuing ${genderPronoun(enemy.sex,"possessive")} magic. All around ${genderPronoun(enemy.sex,"possessive")}, the ground breaks apart as more and more undead climb to the surface.
        Death permeates everything here. You cannot let the army of the dead move back home, or the forces of the ${enemy.name} grow unstoppable. You stand ready, and know this is where it will all end.`}
        else if (knowledge != "clueless" && masterplan == "personalpower") {
        prologue = `${trail}, you have located the ${evilPlace() } where ${enemy.boss} will enact ${genderPronoun(enemy.sex,"possessive")} masterplan. Citadel agents escort you to the remote location. The
        world around you is nothing like the one you have lived in all of your life. ${enemy.boss} has apparently shifted the place to another dimension, one where the dark winds sting your skin and the
        very air around you smolders your throat and lungs.  The sky is a boiling, writhing mass of clouds, each black as coal but glowing with an intense, blood-red heat. If there is a hell, this may as well be it.<br><br>
        You see ${enemy.boss}, not far away, continuing ${genderPronoun(enemy.sex,"possessive")} magic. "${gloat[0]}" ${enemy.boss} tells you. "${gloat[1]}" You stand ready, and know this is where it will all end.`}
        else {prologue = `You come to your senses as undead hands are gripping you and guiding you upwards to an ominous altar on a large pedestal in front of you. What ${mysticalSynonym()} sorcery had kept you
        enthralled is weakening, and you put the zombie down. "${gloat[0]}", ${enemy.boss} looks down at you and shouts, as dark winds sting your skin and the very air around you smolders your throat and lungs:
        "${gloat[1]} ${rivalpresence == true ? (rivalboost == true ? `" ${rival}, standing there, turns and faces you unnaturally black eyes. "Get the gladiators, a` : `"Get them up here, ${rival}! A`) : `Get up here and die, a` }nd this all will be over sooner!"<br><br>
        You still feel dizzy and uneasy and don't quite have your bearings at this ${evilPlace()}, but one thing you're certain of: you will not let ${enemy.boss} get away with this.`};
    break;
    
    case "Poison the Well":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Remove each copy of Vandal Addict from the stage deck and remove them from the game. Shuffle the stage deck.`,false,false,false],[`Each fighter searches the stage deck for 1 copy of Infected Rats and adds it to their Threat area. Shuffle the stage deck.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "actsofterror") {
        prologue = `${trail}, you were able to find your way to ${enemy.boss}${possessiveSuffix(enemy.boss)} secret sewer lair. As you enter a large chamber, you find what used to be a water treatment facility that is now being
        used as some sort of insane science experiment. "${gloat[0]}" came a voice, echoing from somewhere else in the chamber.<br><br>
        The ${enemy.bosstitle} of the ${enemy.name} enters your view from the shadows and ${genderPronoun(enemy.sex,"subject")} continues: "${gloat[1]}
        Once we get these pumps working, all the water in the city will be poisoned, and many, many people will die in a humiliating pandemic of super-diarrhea. But you won't be here to see it!"`}
        else if (knowledge != "clueless" && masterplan == "strengtheningforces") {
        prologue = `${trail}, you were able to find your way to ${enemy.boss}${possessiveSuffix(enemy.boss)} secret sewer lair. As you enter a large chamber, you find what used to be a water treatment facility that is now being
        used as some sort of insane science experiment. "${gloat[0]}" came a voice, echoing from somewhere else in the chamber.<br><br>
        The ${enemy.bosstitle} of the ${enemy.name} enters your view from the shadows and ${genderPronoun(enemy.sex,"subject")} continues: "${gloat[1]}
        Once we get these pumps working, all the water in the city will be blessed by our new serum. The weak will die, and the surviving strong will join our ranks as thralls. So now you have a choice: join us, or die!"`}
        else {prologue = `You wake up, and the first thing you notice is the intense stench attacking your nostrils. You open your eyes, and as you focus, you can see ${enemy.boss} at a distance. You seem
        to be underground, in some kind of a crazy scientist setup, and ${enemy.minions} are moving canisters about big machinery.<br><br>"Oh, you're awake?!" ${enemy.boss} says, annoyed. "I was hoping you would
        not come to your senses before our bath would be ready for you!" You don't think this would be good for your skin, so you diplomatically refuse. The ${enemy.name}${possessiveSuffix(enemy.name)}
        goons don't seem to respond to kind words alone${rivalpresence == true ? `,nor does their foreman ${rival}` : ``}${rivalboost == true ? `, who looks to be pumped up on Vandal` : ``}.`};
    break;
    
    case "Right to Remain Silent":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Each fighter searches the stage deck for a copy of Sneaking, and puts it in their play area.`,false,false,false],[`Add one power to Recoverd Intel.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "illegalgains") {
        prologue = `${trail}, you find out that ${enemy.boss} has several prominent members from a number of tech and finance companies hostage, and are leveraging their position to extort ludicrous sums of untracable cash. 
        From your intel, Citadel analysts have pieced together the location of these hostages, and you move in.<br><br>
        You have to rescue the captives - the power and reach of the ${enemy.name} will grow exponentially if the families cave in!`}
        else if (knowledge != "clueless" && masterplan == "kidnapping") {
        prologue = `${trail}, you find out the location of the target of your rescue operation, who has been kidnapped by ${enemy.boss} and ${genderPronoun(enemy.sex, "possessive")} ${enemy.minions}.
        "${enemy.boss} is interrogating ${randFrom(["him","her"])} as we speak," Agent Fletch says. "You have to move in quick, before ${genderPronoun(enemy.sex,"subject")} gets any sensitive information! Some of
        their intel could threaten even the Citadel!"<br><br>
        You arrive to the scene to see several captives, with their faces covered. ${rivalpresence == true ? `${rival} is standing guard over the captives,` : `The enemies are on alert,`} and you don't know which one
        is your mark. "${gloat[0]}", ${enemy.boss} greets you. "${gloat[1]}" ${laconicStatement()}.`} 
        else {prologue = `"Finally awake?" That's the first thing you hear after the splash of stale water jolts you awake. 
        You have no idea how long you've been a hostage of the ${enemy.name}, ${enemy.desc} — but you'd guess it's been at least a few days.<br><br>
        You've been enduring  their tortures as they've tried to get everything they could out of you. 
        You've held out for now but don't know how long you'll be able to keep it up. ${enemy.boss} ${enemy.threat} as ${genderPronoun(enemy.sex, "subject")} stares at you down. "${gloat[0]}" Your silence is deafening as you stare at the floor. "${gloat[1]}" ${enemy.boss} sneers. 
        "I won't be gone for too long, ${defineAddressing(enemy)}. Don't get comfortable."<br><br>
        ${upperCaseInitial(genderPronoun(enemy.sex, "subject"))} exits, and ${rivalpresence == true ? `${rival} stays to guard over you.` : `as soon as the door closes behind ${genderPronoun(enemy.sex, "object")}, you begin working at your bonds.`}`};
    
    break;
    case "Rude Awakening":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Flip all objectives to their inactive side.`,false,false,false],[`Each fighter places 1 damage on the Stage Rules card.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "actsofterror") {
        prologue = `${trail}, you are on the way to the location of ${enemy.boss} with Agent Fletch. "According to Citadel analysts, the goal of the ${enemy.name} has all along been to sow fear and disarray to the city
        by using a ${mysticalSynonym()} ritual to swarm the city with the undead."
        He looks out the window and then nods to you. "See for yourself". Below you see a veritable sea of people, all of them shambling about, all of them appearing broken and decayed.<br><br>
        You slide down the climbing rope and watch as the helicopter flies away. As you look over the zombies around you, you notice in the distance the ${enemy.bosstitle} of ${enemy.name}.
        ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} looks at you and raises ${genderPronoun(enemy.sex,"possessive")} hands. "This is becoming a wonderful day for evil!"
        ${genderPronoun(enemy.sex,"subject")} shouts, and is surrounded by ${mysticalSynonym()} energy. You see even more zombies climb out of the ground at their feet.`}
        else if (knowledge != "clueless" && masterplan == "strengtheningforces") {
        prologue = `${trail}, you are on the way to the location of ${enemy.boss} with Agent Fletch. "According to Citadel analysts, the ${enemy.name} have uncovered a book of ${mysticalSynonym()} knowledge that
        instructs how to raise the dead, and ${enemy.boss} plans to use this to bolster the ranks of the ${enemy.name} until ${genderPronoun(enemy.sex,"subject")} has an unstoppable army!"
        He looks out the window and then nods to you. "See for yourself". Below you see a veritable sea of people, all of them shambling about, all of them appearing broken and decayed.<br><br>
        You slide down the climbing rope and watch as the helicopter flies away. As you look over the zombies around you, you notice in the distance the ${enemy.bosstitle} of ${enemy.name}.
        ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} looks at you and raises ${genderPronoun(enemy.sex,"possessive")} hands. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} shouts, and is surrounded by ${mysticalSynonym()} energy. "${gloat[1]}" You see even more zombies climb out of the ground at their feet.`}
        else {prologue = `${changeOfPlans(trail,finalboss,enemy,stage)}<br><br>
        You find yourself at your destination. You see a veritable sea of people, all of them shambling about, all of them appearing broken and decayed.<br><br>
        As you look over the zombies around you, you notice in the distance ${enemy.boss}, ${rivalpresence == true ? `with ${rival} standing guard, ` : ``}directing a cabal of necromancers!
        ${rivalpresence == true ? `"Stop those Gladiators!" the leader of the ${enemy.name} spits.` : `"I was sure you would be busy with ${finalboss.boss}!" ${genderPronoun(enemy.sex, "subject")} shouts!`}
        ${rivalboost == true ? ` ${rival}, looking like a corpse, hisses and lunges at you!` : ``}`}
    break;
    
    case "Running Wild":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`<b>Feint:</b> Roll 3 enemy dice; for each different result, remove 1 power from "The Final Key".`,true,false,false],[`Each Hero places 3 random defense tokens on the copy of "Hunt for the Idols" in their fighter play area. Each time a Hero searches, these defense tokens block successes and are discarded as normal.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "personalpower") {
        prologue = `${trail}, you have determined that ${enemy.boss} is in a distant forest, after a collection of ancient idols of a lost, ancient temple that ${mysticalSynonym()} texts claim will grant immeasurable power to their keeper.<br><br>
        "You have to hurry, Gladiators," Agent Fletch says, shouting over the roar of the helicopter as you are flown to the target. "Our Citadel scouts report that ${enemy.name} goons have been
        seen in the area for some time now, they must be close to getting what they came for!" He looks out the window and then nods to you. "This is your stop." You slide down the climbing rope and watch as the helicopter flies away. 
        Soon you find the ${enemy.minions} of ${enemy.name} in the forest."<br><br>
        ${enemy.boss} notices notices your approach. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} shouts in anger. "${gloat[1]}"${rivalpresence == true ? `, as ${rival} steps in your way.`:``}`}
        else if (knowledge != "clueless" && masterplan == "illegalgains") {
        prologue = `${trail}, you have determined that ${enemy.boss} is in a distant forest near a forgotten temple ruin, after ancient idols that Citadel analysts state to be valuable beyond measure.<br><br>
        "You have to hurry, Gladiators," Agent Fletch says, shouting over the roar of the helicopter as you are flown to the target. "Our Citadel scouts report that ${enemy.name} goons have been
        seen in the area for some time now, and their power and reach will grow exponentally with the influx of cash from the black market after selling the artefacts!" He looks out the window and then nods to you. "This is your stop." You slide down the climbing rope and watch as the helicopter flies away. 
        Soon you find the ${enemy.minions} of ${enemy.name} in the forest."<br><br>
        ${enemy.boss} notices notices your approach shouts in anger: "${gloat[0].substring(0, gloat[0].length - 1)}!" ${rivalpresence == true ? `, and ${rival} steps in your way`:``}`}
        else {prologue = `${changeOfPlans(trail,finalboss,enemy,stage)}<br><br>
        With help from the locals you have no trouble finding the area with a ruined shrine where the ${enemy.name}${possessiveSuffix(enemy.name)} searches are happening, but turns out they have been scouring the woods for 
        weeks already, and are quite prepared.<br><br>
        When you reach them, you find ${enemy.boss} ${rivalpresence == true ? ` and ${rival}`:``}. "${gloat[0]}"
        ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} says as you are noticed, and ${enemy.threat}.`}
    break;
    
     case "Steel Memories":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`One fighter may move 3 spaces toward the nearest objective.`,false,false,false],[`Each fighter must <b>Recruit</b>.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "actsofterror") {prologue = `${trail}, you have found out that ${enemy.boss} has managed to organize a 12 hour marathon of crimes of every imaginable sort, including murder,
        for this very night. Agent Fletch explains to you: "The ${enemy.name} has provided the people release for all the hatred, and violence, and aggression that they keep up inside them. You need to contain their mob,
        before the mentality spreads any further and the city falls to anarchy!"<br><br>This has been ${enemy.boss}${possessiveSuffix(enemy.boss)} plan all along! You have no choice but to move in and subdue both the ${enemy.minions}, and any outsiders who have
        fallen to ${enemy.boss}${possessiveSuffix(enemy.boss)} manipulations, or the city will never be the same again.`
        }
        else if (knowledge != "clueless" && masterplan == "kidnapping") {
        prologue = `${trail}, you have found out where the secret base of the ${enemy.name} is located and rescue target is being held. You accompany a squad of Citadel soldiers as they storm the base.
        ${enemy.name} soldiers fall before you, and you make your way through the maze-like halls until you finally reach an elevator.
        You wait patiently, while a lounge version of ${loungeMusic()} plays over the cheap speakers.<br><br>
        When you arrive, ${enemy.boss} is waiting for you, standing ready. "${gloat[0]}" ${genderPronoun(enemy.sex, "subject")} says. "${gloat[1]}" ${laconicStatement()}.`
        }
        else {prologue = `You wake up in a pitch black room and turn around, hoping to find some sort of reference to where exactly you are, but not fully recovered. All you see is the ever-encroaching blackness and
        the deafening silence surrounding you.<br><br>
        And then, the lights in the room snap on, almost blinding you with their intensity. You blink, and see standing before you the ${enemy.bosstitle} leader of the ${enemy.name}:
        ${enemy.boss}. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} says, smirking.${rivalpresence == true ? ` "It is time you prove your worth, ${rival}!" ${enemy.boss} exclaims.`: `"${gloat[1]}"`}`
        };
    break;
    
    case "Sudden Death":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Put one random defense toke on each copy of "A New Challenger".`,false,false,false],[`The active objective token nearest ${enemy.boss} advances 4 spaces toward ${enemy.boss} and attacks.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "kidnapping") {
        prologue = `${trail}, you found that ${enemy.boss} has kidnapped, along with the target of your rescue mission, a whole lot of people from all walks of life, and intends to make them fight to death
        for ${genderPronoun(enemy.sex,"possessive")} own entertainment! Agent Fletch informs you that you have the location of the ${enemy.name}${possessiveSuffix(enemy.name)} secret base. You head there with
        Citadel soldiers, who clear the upper levels while you find your way to an elevator, and proceed down to the heart of the complex. You patiently wait while a lounge version of
        ${loungeMusic()} plays over the cheap speakers.<br><br>
        There you find ${enemy.boss} in the middle of the captives. "So today's lesson is," ${genderPronoun(enemy.sex,"subject")} says. "You kill each other off till there's only one left.
        Nothing's against the rules." You must put an end to this to rescue your mark! "All are welcome to participate!" says ${enemy.boss} as ${genderPronoun(enemy.sex,"subject")} turns to you.`
        }
        else if (knowledge != "clueless" && masterplan == "strengtheningforces") {
        prologue = `${trail}, you have found out that ${enemy.bosstitle} ${enemy.boss} has been covertly organizing a new underground tournament under a mainstream event's shadow,
        recruiting soldiers into the ${enemy.name}. Citadel analysts say that this has the most extensive recruiting potential of any of the similar plots in the recent past.<br><br>
        The ${enemy.name} is operating behind a legitimate event to hundreds of fighters from all over the globe. The winners are again offered prestigious positions as officers in the ${enemy.name}${possessiveSuffix(enemy.name)} armed forces. The winners who refuse this
        offer are naturally captured and killed. You can't let this happen. You once more infiltrate a network of underground street fights focused on bringing the most ruthless fighters out of the woodwork, and
        once more have no choice but to enter the fight and shut down the ${enemy.name} efforts first hand.`
        }
        else {
        prologue = `Hands tied behind your back, you are led by ${enemy.boss} and ${minion} into an oddly-placed urban clearing. The out-of-place streets are
        hosting several fighters, each of them sparring in deadly martial arts. "You're not worthy to walk on this ground," ${minion} growls, glaring at you with a deep-seated hatred.
        "And so", ${enemy.boss} interjects. "We will allow you the chance to prove your worth. ${finalboss.boss == enemy.boss? `I have developed a great interest in you.
        I would be pleased if you'd demonstrate it to my doubting minion.` : `${finalboss.boss} has taken great interest in you. Show us why that is.`}"<br><br>"This is unnecessary," ${minion} says quietly to ${enemy.boss}. "You play games with the trust of the ${finalboss.name == enemy.name ? "Master" : finalboss.name}."
        ${enemy.boss} loosens your bonds, ignoring ${minion}${possessiveSuffix(minion)} words. You grab your wrists as they are free, rubbing the pain away, and watch as the other fighters turn toward ${enemy.boss},
        preparing for what you're assuming will be a fight to the death. The other fighters show no fear, their eyes looking only for glory${rivalboost == true ? `, and ${rival} looking especially eager to beat you to a pulp` : ``}.`
        }
    break;
    
    case "Supply & Demand":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Any fighter may put this card in their play area. <b>Feint:</b> Remove this card from the game to choose one enemy to drop an objectve token it is carrying.`,false,false,false],[`${enemy.boss} gains 1 random defense token. Each fighter is dealt 1 direct damage.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "illegalgains") {
        prologue = `${trail}, you have found out that the ${enemy.name} is conducting an immense international drug deal with a Vandal-derivative drug load on a remote island.<br><br>
        Agent Fletch sits behind the pilot's seat of the Citadel plane takes you to your location. "We're coming up on the ${enemy.name}${possessiveSuffix(enemy.name)} location," he says to you. 
        "I'll see if I can put her down over-" His words are interrupted as an explosion from an anti-air shell shakes the plane. "Nevermind, looks like you're jumping in!"
        Grabbing a parachute, you leap from the plane as it peels off and heads toward safety.<br><br>
        You land just outside the camp that was firing at the Citadel aircraft, and you hear gunfire in the distance. "We've reached the camp," you say to Fletch via your radio. 
        ${rivalpresence == true && rivalboost == true ? `You would have finished your sentence weren't for ${rival} who leaped from the shadows and delivered a powerful attack square to your face.` : `"We have found ${enemy.boss}."`}
        You have to stop the ${enemy.boss} here and now, or their reach and power will grow exponentially with the leverage and cash the deal will deliver them.`
        }
        else if (knowledge != "clueless" && masterplan == "actsofterror") {
        prologue = `${trail}, you find out that the ${enemy.desc} of the ${enemy.name} are planning to openly flood the streets of the city with free samples of a Vandal-derivative drug. Citadel analysts have determined the location and time of
        their plan, and you move in to intervene.<br><br>
        A Citadel chopper drops you at the remote beach where the ${enemy.name}${possessiveSuffix(enemy.name)} distribution of product is taking place. "${gloat[0]}" ${enemy.boss} says. "${gloat[1]}" You have to stop the distribution here and now, or the city will experience unprecedented drug problems - and the people will know no-one can stop ${enemy.name}`
        }
        else {
        prologue = `${changeOfPlans(trail,finalboss,enemy,stage)}<br><br>
        You have approached the site stealthily, and are just about to attack. Standing nearby, the ${enemy.bosstitle} ${enemy.boss} watches over the activity. ${rivalpresence == true ? `During their work,
        one of the soldiers spots you and drops his crate, a large amount of illegal drugs spilling out onto the concrete loading dock. You duck behind cover, but ${rivalboost == true ? `out of nowhere
        ${rival} leaps from the shadows and delivers a powerful strike square to your face.` : `${rival} calms ${genderPronoun(enemy.sex,"object")}, saving the unlucky soldier: "Somebody's back there!"`}` : `Suddenly,
        the soldiers carrying the goods drop their crates where they stand, illegal drugs spilling out! You have to stop the deal here and now!`}`
        };
    break;
    
    case "The Ceremony":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`Flip 2 objective tokens to their inactive side.`,false,false,false],[`Each fighter must either discard a card at random or place 1 power on "Oni's Vessel".`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "personalpower") {prologue = `${trail}, you've determined where ${enemy.boss} will enact ${genderPronoun(enemy.sex,"possessive")} plan of receiving the ultimate power. You reach the ${evilPlace()}
        nestled deep in in the wilds where the ritual is to take place - to find ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} forces already starting the ritual.<br><br>"${gloat[0]}" ${enemy.boss} calls with confidence, ${genderPronoun(enemy.sex,"possessive")} voice echoing off the stone walls.
        You see the main chamber of the temple has multiple pedestals, each with a mysterious urn placed on top. The urns are etched with a series of ${mysticalSynonym()} images.
        Thinking that these may be part of the ritual, you quickly remove them from their pedestals. "${gloat[1]}" ${enemy.boss} calls out. ${upperCaseInitial(genderPronoun(enemy.sex,"possessive"))} forces ${rivalpresence == true ? `led by ${rival} `: ``}charge you while
        ${genderPronoun(enemy.sex,"subject")} continues the ritual.<br><br>The time has come for your final confrontation!`}
        else if (knowledge != "clueless" && masterplan == "kidnapping") {prologue = `${trail}, you've determined that ${enemy.boss} plans to sacrifice ${genderPronoun(enemy.sex,"possessive")} captive to appease a dark power in a certain ${evilPlace()}. You reach the location
        to find ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} forces already starting the ritual. You see the captive chained, too tightly for you to free ${randFrom(["him","her"])} without defeating the ${enemy.name} first.<br><br>
        "${gloat[0]}" ${enemy.boss} calls with confidence, ${genderPronoun(enemy.sex,"possessive")} voice echoing off the stone walls.
        You see the main chamber of the temple has multiple pedestals, each with a mysterious urn placed on top. The urns are etched with a series of ${mysticalSynonym()} images.
        Thinking that these may be part of the ritual, you quickly remove them from their pedestals. "${gloat[1]}" ${enemy.boss} finishes. ${upperCaseInitial(genderPronoun(enemy.sex,"possessive"))} force ${rivalpresence == true ? ` led by ${rival}`: ``}charge you while
        ${genderPronoun(enemy.sex,"subject")} continues the ritual.<br><br>The time has come for your final confrontation!`}
        else {prologue = `${changeOfPlans(trail,finalboss,enemy,stage)}<br><br>
        ${trail}, you reach the ${evilPlace()} nestled deep in in the wilds - to find ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} forces already starting the ritual.<br><br>"${gloat[0]}" ${enemy.boss} calls with confidence, ${genderPronoun(enemy.sex,"possessive")} voice echoing off the stone walls.
        You see the main chamber of the temple has multiple pedestals, each with a mysterious urn placed on top. The urns are etched with a series of ${mysticalSynonym()} images.
        Thinking that these may be part of the ritual, you quickly remove them from their pedestals. ${rivalpresence == true ? `${rivalboost == true ? `${rival}, possessed by a supernatural force, moves in to intercept you. ` : `${rival} eyes you from ${enemy.boss}${possessiveSuffix(enemy.boss)} side. `}` : ``}"Your efforts are futile!" ${enemy.boss} calls out. ${upperCaseInitial(genderPronoun(enemy.sex,"possessive"))} forces charge you while
        ${genderPronoun(enemy.sex,"subject")} continues the ritual.`}
    break;
    
    case "Under Destruction":
        instructions = setUpInstructions(stageindex,enemy,rival,rival2,knowledge,[`<b>Exhaust:</b> Move 1 power from a Time Bomb card to this card. Then, if there's 5 power on this card, remove it from the game.`,true,false,false],[`Each fighter chooses a different objective and places 1 power on the chosen objective.`,false,false,false])
        setup = setup + instructions[0]; rivalpresence = instructions[1]; rivalboost = instructions[2]
        if (knowledge != "clueless" && masterplan == "actsofterror") {
        prologue = `${trail}, you find out that ${enemy.boss} is going to bring the ${randFrom(["White House","Pentagon","police headquarters","Citadel HQ","city hall"])} down! ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} has set enough explosives inside a part of the building closed for renovation to bring down the whole
        building and much of the surrounding area, and it is happening right now. There is no-one but the Global Gladiators who can react with enough speed and
        precision!<br><br>
        You rush to the location, past a few confused security with the assistance of Citadel agents. In the constuction area, you find ${enemy.boss} ${rivalpresence == true ? `and ${rival} ` : ``}along with the ${enemy.minions} of the ${enemy.name}. "Too late, ${defineAddressing(enemy)}!"
        ${genderPronoun(enemy.sex,"subject")} shouts. "The whole building will go down, and you will go down with it!"`}
        else if (knowledge != "clueless" && masterplan == "illegalgains") {
        prologue = `${trail}, you find out that the ${enemy.name} has gone through a lot of trouble to aquire a large building complex with very little investments, and is planning to level the place, having
        planted enough evidence that the ${competitor.name} will take the blame, and you know you cannot disprove it. The value of this scheme is unbelievable, and or their reach and power will grow exponentially should they succeed. You move quickly to the location.<br><br>
        You arrive, and find ${enemy.boss} ${rivalpresence == true ? `and ${rival} ` : ``}setting up the last of the explosives, along with ${enemy.minions} of the ${enemy.name}. "Too late, ${defineAddressing(enemy)}!"
        ${genderPronoun(enemy.sex,"subject")} shouts. "The whole building will go down, and you will go down with it!"`}
        else {
        prologue = `You open your eyes and find yourself in.. an unfinished construction site? Suddenly, ${enemy.boss} steps out from the shadows. "${gloat[0]}" ${enemy.boss} shouts. 
        "${gloat[1]}" You note that ${enemy.minions} are suddenly blocking every exit, except for the one ${enemy.boss} is guarding. "The whole place is rigged with
        explosives, ${rivalpresence == true ? `and some would even pay to watch you die!" At that, ${rival} steps into view. ${rivalboost == true ? `"But I'm a hands-on kind of person," ${rival} adds,
        and moves at you.` : ``}` : `and I will gladly expend some foot soldiers to get to watch you being.. demolished!"`}<br><br>
        No matter if this sounds contrived, you have no choice but to fight your way out - and fast!`};
    break;
    default: 
    prologue = "The stage has no stage intro defined.<br>"
    }
    
    return {prologue: prologue, setup: setup, winepilogue: winepilogue, loseepilogue: loseepilogue}
}

function changeOfPlans(trail,finalboss,enemy,stage) {
    
    
    let newintel = randFrom([
        `There is no time for regrets, and you need to leave the failure of stopping ${finalboss.boss} behind. ${preGamePrologue(stage,enemy)[1]}`,
        `Citadel analysts have gone over every bit of intel you have gathered on ${finalboss.boss}, but have nothing to go on. But there are more pressing concers. ${preGamePrologue(stage,enemy)[1]}`,
        `While you may have lost the fight, the battle is far from over. ${preGamePrologue(stage,enemy)[1]}`,
        `Focusing on ${finalboss.boss} has let other, just as devious issues grow. ${preGamePrologue(stage,enemy)[1]}`
        ])
    
    let conclusion = randFrom([
        `, you slowly come to the conclusion that you have failed to locate ${finalboss.boss}. But suddenly, Agent Fletch contacts you and says: "${newintel}"`,
        `, you decide you need to contact Agent Fletch for assistance, as you don't have a clue where to proceed. "${newintel}"`,
        `, you conclude that ${finalboss.boss} has won this time. ${newintel}`,
        `, you accept your defeat and retreat to Citadel HQ. ${newintel}`,
        `, you realize you will not be able to catch ${finalboss.boss}. Meeting up with Agent Fletch, he says: "${newintel}"`
        ])
    
    conclusion = trail+conclusion
    
    return conclusion
}

function finalResult(masterplan, enemy, rival, result) {
    
    let neutralize
    
    switch (masterplan) {
        case "kidnapping": neutralize = `hostage of the ${enemy.name} has been aquired`
        break;
        case "personalpower": neutralize = `power levels of the ${enemy.bosstitle} remain in check`
        break;
        case "strengtheningforces": neutralize = `army of the ${enemy.name} has been neutralized`
        break;
        case "actsofterror": neutralize = "plan to destablize the city has been countered"
        break;
        case "illegalgains": neutralize = `plan to fund ${enemy.name} operations has been countered`
        break;
        default: "is stopped."
    }
    
    let winresult = [
        `"Gladiator?" Agent Fletch's voice sounds in your ear, small and tinny from your damaged communicator. "What's the status?" You press your finger to the comm button. "The ${neutralize}," you respond, breathing heavily. "${enemy.boss} has been defeated but is nowhere to be found. `,
        `"You may have me," ${enemy.boss} says as the Citadel agents surround them. "But I am only one." Agent Fletch approaches. "Say goodbye to your precious ${enemy.name}," he says. ${randFrom([rival,randFrom(enemy.minionnames)])} laughs. "Who do you think you're working for?"`,
        `"You may have me," ${enemy.boss} says as the Citadel agents surround them. Suddenly, ${genderPronoun(enemy.sex,"subject")} starts to deteoriorate, and in mere seconds, there's nothing but dust left. Agent Fletch approaches. "It must have been a clone! At least the ${neutralize}, that's a victory in my books."`,
        `In a blinding flash, ${enemy.boss} disappears just as Agent Fletch approaches. "The ${neutralize}," you report. "We may have won the battle, but the war is not over," Agent Fletch says.`,
        `You ensured that the ${neutralize}. As ${enemy.boss}${possessiveSuffix(enemy.boss)} minions flee, ${genderPronoun(enemy.sex,"subject")} wipes blood from ${genderPronoun(enemy.sex,"possessive")} mouth. "We're not done. This is MY city. The ${enemy.name} never forgets! So you better never show your face here again! With that, they quickly fled in the darkness.`,
        `With each blow to ${enemy.boss}, ${genderPronoun(enemy.sex,"subject")} attempts to fight you off. Finally, ready to end it all, you swing with what will be your final attack, but suddenly there's blinding flash and  ${genderPronoun(enemy.sex,"subject")}'s gone.`,
        `With ${enemy.boss} defeated, Citadel soldiers secure the area and you return home. Now that the ${neutralize}, the mayor arranges a parade for the heroes of the city, and most of you get a medal!`,
        `Suddenly, there's a blinding flash and ${enemy.boss}${possessiveSuffix(enemy.boss)} gone! It's all gone. Shockingly, you're back at Citadel HQ, surrounded by agents all going about their business. Did all that even happen?`,
        `You are lying in the corner, exhausted, all enemies defeated - but their master is nowhere to be found. "You've done a hero's job, Gladiators. I guess you're through, huh?" Agent Fletch asks as he approaches you. "Finished," you answer wearily. "It's too bad we couldn't catch ${enemy.boss}. But then again, who could?"`,
        `Your intense fight takes you to the edge of an unfathomably deep pit. Just as you're about to strike ${enemy.boss} down, ${genderPronoun(enemy.sex,"subject")} dives in, and that's the last you see of ${genderPronoun(enemy.sex,"object")}. For now!`,
        `You are sure you you have cornered ${enemy.boss} with no route of escape, when all of a sudden a sleek ${enemy.name} helicopter descends and ${genderPronoun(enemy.sex,"subject")} leaves, dangling from a ladder. "The ${neutralize}, but ${enemy.boss} slipped away," you report to Agent Fletch with your communicator.`,
        ]
    
    let finisher = randFrom(["Finish them","Show no mercy","End them","Put an end to this","Kill them, and send what remains to Agent Fletch","Wipe them out, all of them","Put a stop to this"])
        
    let gloat = gloatingList(enemy)
    let submission = lastWords(enemy)
    let defiance = defiantEnd(enemy)
    let lastwords = randFrom([submission,defiance])
    let lastthoughts = lastThoughts(enemy)
    
    let loseresult = [
        `"${gloat[0]}" ${enemy.boss} says, arms crossed confidently in front of ${genderPronoun(enemy.sex,"object")}. "${gloat[1]}" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} turns to face ${rival + " and " + randFrom(enemy.minionnames)}, ${genderPronoun(enemy.sex,"possessive")} final command echoing powerfully off the walls with a sudden finality. "${finisher}!"`,
        `"${gloat[0]}" ${enemy.boss} says as your body is strapped into a large metal apparatus in ${enemy.boss == "Jackal" ? "her" : "Jackal's"} laboratory. "${gloat[1]}"`,
        `"Gladiator?" Agent Fletch's voice sounds in your ear, small and tinny from your damaged communicator." What's the status?" You watch from your place on the floor, unable to respond as ${enemy.boss} returns to ${genderPronoun(enemy.sex,"possessive")} plan.`,
        `"${lastwords[0]}" ${heroSpeech()}. "${lastwords[1]}." ${enemy.boss} laughs wickedly. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} gloats. "${gloat[1]}"`,
        `${lastthoughts} ${enemy.boss} laughs wickedly. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} gloats. "${gloat[1]}"`,
        `${enemy.boss} pushes you down, forcing you into submission. You try to fight ${genderPronoun(enemy.sex,"object")} off but can't, and instead watch in horror as ${genderPronoun(enemy.sex,"subject")} ${enemy.threat}. Your scream is lost on the winds as ${genderPronoun(enemy.sex,"subject")} extinguishes your life!`,
        `Last of the Gladiators have fallen to ${enemy.boss} and ${genderPronoun(enemy.sex,"possessive")} ${enemy.minions}. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} says. "${gloat[1]}" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} ${enemy.threat}.`,
        `"${gloat[0]}" says ${enemy.boss} as ${genderPronoun(enemy.sex,"subject")} ${enemy.threat}. ${randFrom([`You can only watch, horrified.<br>"${gloat[1]}"`,`"${gloat[1]}"<br>${lastthoughts}`])}`,
        `"${gloat[0]}" ${enemy.boss} says, and ${enemy.threat}. Those are the last words you ever hear.`,
        `"Maybe The Master would have a better use for the Gladiators?" ${randFrom(enemy.minionnames)} asks. "No," ${enemy.boss} answers${randFrom([` as ${genderPronoun(enemy.sex,"subject")} ${enemy.threat}`,`, and orders: "${finisher}"`])}.`,
        `You gave all you've got, but it was not enough. Not even close. "${finisher}!" ${enemy.boss} orders ${randFrom(enemy.minionnames)}.`,
        `${enemy.boss} stands over your limp body. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} says, as ${genderPronoun(enemy.sex,"possessive")} ${enemy.minions} draw nearer. "${gloat[1]} ${finisher}!" The minions follow the order.`,
        `As you're lying on the ground, bleeding out,${randFrom([``,` ${heroSpeech()}: "${lastwords[0]}", but the ${enemy.bosstitle} cuts you off.`,`${lowerCaseInitial(lastthoughts)}`])} "${gloat[0]}" ${enemy.boss} says. "${gloat[1]}"`,
        `"${gloat[0]}" the ${enemy.bosstitle} says. You don't answer anything. ${lastthoughts} ${enemy.boss} goes on: "${gloat[1]}" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} ${enemy.threat}.`,
        `"${gloat[0]}" ${enemy.boss} shouts. ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} ${enemy.threat}. "${gloat[1]}"`,
        `"${gloat[0]}" ${enemy.boss} says, hellfire twinkling visibly in ${genderPronoun(enemy.sex,"possessive")} eyes. "${gloat[1]}"`,
        `You are lying on the ground, defeated. "${finisher}!" ${enemy.boss} orders${randFrom([` ${genderPronoun(enemy.sex,"possessive")} goons.`,`. ${lastthoughts}`])}`,
        `You try to stagger away from your defeat. "${gloat[0]}" ${enemy.boss} growls, while ${genderPronoun(enemy.sex,"subject")} comes at you, unrelenting. "${gloat[1]}"`,
        `With ${genderPronoun(enemy.sex,"possessive")} right hand, ${enemy.boss} grabs your face and pushes your aching body, sapped of all strength, slowly backward toward a bottomless chasm. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} says. "${gloat[1]}"` ,
        `Agent Fletch and Citadel soldiers have arrived just a few moments too late. "${submission[0]}" ${heroSpeech()}, and fall forever silent. Fletch lets out a scream of despairing anguish, knowing you were senselessly lost because of miscommunications and bad timing.`,
        `Agent Fletch finds you broken and battered where ${enemy.boss} left you. "${submission[0]}" ${heroSpeech()}. "${submission[1]}"<br><br>You close your eyes slowly and your head goes limp.`,
        `"${finisher}!" ${enemy.boss} orders. The ${enemy.minions} remorselessly beat you until you feel nothing.`,
        `${enemy.boss} looks at you, lying at ${genderPronoun(enemy.sex,"possessive")} feet. "${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} says, looking disappointedly at you. "${gloat[1]}${randFrom([` ${finisher}." ${randFrom(enemy.minionnames)} steps closer.`,`" ${upperCaseInitial(genderPronoun(enemy.sex,"subject"))} ${enemy.threat}.`])}`,
        `"${lastwords[0]}" ${heroSpeech()}. "${lastwords[1]}"<br><br>"${gloat[0]}" ${enemy.boss} answers. "${gloat[1]}"`,
        `Citadel aircraft speeds you to medical care, but you know it is too late. "${submission[0]}" ${heroSpeech()} to Agent Fletch, at your side.<br><br>"${submission[1]}"`,
        `"Gladiator?" Agent Fletch's voice penetrates your fading mind. "${submission[0]}" ${heroSpeech()}, before the darkness overcomes you.`,
        `You are lying on your back, the pain preventing you from moving. ${randFrom([`${lastthoughts}. and this is the last thought you will ever have.`,`"${submission[0]}" ${heroSpeech()} to no-one in particular as you draw your last breath. "${submission[1]}."`])}`,
        `Citadel soldiers are clearing the area from the aftermath of your fight, long after victorious ${enemy.boss} has left. "${submission[0]}" ${heroSpeech()} to Agent Fletch. "Don't try to speak," he answers, but you know it will not make any difference. ${upperCaseInitial(heroSpeech())} your last words: "${submission[1]}"`,
        `"Finish them off, ${enemy.boss}! Do it now!" shouts ${randFrom(enemy.minionnames)}. "${gloat[0]}" ${enemy.boss} says, and ${enemy.threat}. "${gloat[1]}"`,
        `"${randFrom([`No more, ${enemy.boss}! Grant me mercy!" you shout.`,`${lastwords[0]}" ${heroSpeech()}, "${lastwords[1]}"`])} ${enemy.boss} ${enemy.threat}${randFrom([`. "I thought you were made of sterner stuff," ${genderPronoun(enemy.sex,"subject")} responds.`,`, and orders ${genderPronoun(enemy.sex,"possessive")} minions: "${finisher}!"`])}`,
        `${enemy.boss} has you pinned. Without a word, ${genderPronoun(enemy.sex,"subject")} ${enemy.threat}. With grim determination in ${genderPronoun(enemy.sex,"possessive")} eyes ${genderPronoun(enemy.sex,"subject")} ends your life.`,
        `"${defiance[0]}, ${enemy.boss}," you spit defiantly in the face of the victorious ${enemy.bosstitle}. "${defiance[1]}"<br><br>"${gloat[0]}" ${genderPronoun(enemy.sex,"subject")} answers. "${gloat[1]}"`,
        `"${lastwords[0]}" ${heroSpeech()}, but ${enemy.boss} cuts you off by grabbing your throat. "${gloat[0]}", ${genderPronoun(enemy.sex,"subject")} says and starts to squeeze the life out of you. "${gloat[1]}"`
        ]

    let finalresult
    
    result == 1 ? finalresult = randFrom(winresult) : finalresult = randFrom(loseresult)
    
    return finalresult
    
}

function heroSpeech () {
    let effort = [` `,` manage to `,]
    let speak = [`cough out`,`wheeze`,`utter`,`gasp`,`say`,`hiss`,`groan`]
    let descriptive = [`with your last bit of strength`,`with a smile`,`through bloodied lips`]

    return "you" + randFrom(effort) + randFrom(speak)
}

function defiantEnd (enemy) {
    let defiance = [
        [`You're sick, ${enemy.boss},`,`Where do people like you come from?`],
        [`You won't get away with this!`,`Citadel will make sure of it!`],
        [`No matter where you or what you do,`,`You're going down.`],
        [`When beasts like you have devoured each other,`,`The world will belong again to the little people.`],
        [`Come on down. You haven't got a chance,`,`Come on!`],
        [`Come on, I love it. Bring on some more!`,`Come on, ${enemy.boss}!`],
        [`Just finish this,`,`What are you waiting for?`],
        [`Was that all you got?`,`I excpected more of you.`],
        [`One day another Gladiator will rise`,`and you shall fall.`],
        [`It is better to burn out,`,`Than to fade away.`]
    ]

    return randFrom(defiance)
}

function lastWords(enemy) {
    let lastwords = [
        [`Tomorrow, at sunrise..`,`I shall no longer be here.`],
        [`I was not supposed to die, not here..`,`Not like this.`],
        [`Do not grieve,`,`One day another Gladiator will rise and uses the power of ${randFrom(["Street Masters","Vandal","Dynasty Cells","Dark Matter"])} to light our darkest hour.`],
        [`It's over,`,`Goodbye.`],
        [`One never knows the ending,`,`One has to die to know exactly what happens after.`],
        [`If I'll close my eyes now,`,`I'm not going to wake up.`],
        [`I must go in..`,`The fog is rising.`],
        [`Tired..`,`So.. tired.`],
        [`I was supposed to die in France..`,`I never even saw France.`],
        [`Goodbye..`,`Farewell.`],
        [`You always were a pain in the rear,`,`It was nice knowing you.`],
        [`I'm afraid,`,`And I'm glad to be afraid.`],
        [`I'm a leaf on the wind,`,`Watch how I..`],
        [`It's been a funny sort of day,`,`Isn't it?`],
        [`It's..`,`Beautiful.`],
        [`I'll see you in another life,`,`When we are both Tigers.`],
        [`Death smiles at us all,`,`All you can do is to smile back.`],
        [`I got what everyone gets,`,`I got a lifetime`],
        [`Time..`,`To die.`],
        [`My only hope,`,`Is that the next team will do what I could not.`],
        [`My only regret is that I failed to stop the ${enemy.name}${possessiveSuffix(enemy.name)} scheme,`,`And my failure has doomed the city.`],
        [`I can only think of all the innocent lives that will perish,`,`Because of this insane scheme I failed to thwart.`],
        [`I gave everything,`,`I have no regrets.`],
        [`When death comes,`,`It will come as an old friend.`],
        [`To dream, perchance to sleep,`,`Aye, there's the rub.`]
    ]

    return randFrom(lastwords)
}

function lastThoughts(enemy) {
    let lastthoughts = [
        `You can only think of all the innocent lives that will perish because of this insane scheme you failed to thwart.`,
        `Your only regret is that you failed to stop the ${enemy.name}${possessiveSuffix(enemy.name)} scheme, and your failure has doomed the city.`,
        `From out of nowhere a thought crosses your mind: one day another Gladiator will rise and uses the power of ${randFrom(["Street Masters","Vandal","Dynasty Cells","Dark Matter"])} to light our darkest hour.`,
        `You can only think that if you'll close your eyes now, you're not going to wake up.`,
        `You think to yourself it's been a funny sort of day in a way.`,
        `Your only hope is that the next team Agent Fletch will send will do what you could not.`,
        `The key, you think, is not to think of death as the end, but as a very effective way of cutting your expences.`,
        `If only, you think, you had a few more coins to insert.`
    ]

    return randFrom(lastthoughts)
}

function gloatingList(enemy) {
    let gloating = [
        ["You fought well,","There will be no-one to mourn your death."],
        [`${enemy.boss == "Jackal" ? "I" : "Jackal"} couldn't have asked for better specimens,`,`It's time you provide your skills and abilities to the ${enemy.name}.`],
        ["I'm not even going to kill you myself!","I'll let my minions take care of that."],
        [`Everything comes to ${genderPronoun(enemy.sex,"object")} who waits,`,"And I have waited for so very long for this moment."],
        [`Where are they now? Where are your friends now?`, `Tell me about the loneliness of good. Is it equal to the loneliness of evil?`],
        [`This is finally turning into my kind of day,`,`The monument to my humble genius is now complete!`],
        [`Mwahahaha!`,`I'm so powerful I even impress myself!`],
        [`Please meet your end with dignity,`,`I hate whiners.`],
        [`Only you were brave - or stupid enough to oppose the ${enemy.name}.`,`The city is now under martial law.. and I am the marshal.`],
        [`This was almost too easy,`,`Such heroic nonsense.`],
        [`${upperCaseInitial(defineAddressing(enemy))}!`,`Why throw away your lives so recklessly?`],
        [`I would've waited an eternity for this,`,`It's over, ${defineAddressing(enemy)}.`],
        [`It's a pity you Gladiators die so easily,`,`Or I might have a sense of satisfaction now.`],
        [`Come now, ${defineAddressing(enemy)},`,`We all must die sometime.`],
        [`You don't have to do this," you say. "People always say the same thing,`, `They say: 'You don't have to do this'.`],
        [`Have you ever seen blood in the moonlight, ${defineAddressing(enemy)}?`,`It appears quite black.`],
        [`Do you like life?" ${enemy.boss} asks. "Yes," you answer. "That's good,`,`Because I take no pleasure in taking a life if it’s from a person who doesn’t care about it.`],
        [`You should've moved to a small town, somewhere the rule of law still exists,`,`You will not survive here. You are not a dragon, and this is a land of dragons now.`],
        [`It looks like you have run out of luck,`,`How dare you challenge us?!`],
        [`Proud of yourself, ${randFrom([defineAddressing(enemy),"little Gladiator"])}?`,`Time to die!`],
        [`C'mon, Gladiator. I'm right here, but you've gotta hit straight!`,`Straight doesn't seem to be good enough! Now it's my turn!`],
        [`Horror has a face,`,`And you must make a friend of horror. Horror and moral terror are your friends. If they are not, then they are enemies to be feared.`],
        [`Now watch closely, everyone,`,`I'm going to show you how to kill a Global Gladiator.`],
        [`I don't blame myself,`,`You see, ${defineAddressing(enemy)}, most people never have to face the fact that, at the right time and the right place, they're capable of anything.`],
        [`There are times when I...`,`I look at people and I see nothing worth liking.`],
        [`You think there are victims? Don't be melodramatic`,`Look down there," ${genderPronoun(enemy.sex,"subject")} gestures at a satellite image of the city. "Tell me, would you really feel any pity if one of those dots stopped moving forever?`],
        [`Everything I touch becomes food for my hunger,`,`My hunger for power!`],
        [`I will win by any means!`,`By any cost!`],
        [`Power flows to the one who knows how,`,`Desire is not enough.`],
        [`This is becoming a wonderful day for evil,`,`Soon I shall have all in my power!`],
        [`You were always too late,`,`All your efforts were futile.`],
        [`Won't you please think of the children, ${enemy.boss}?" you plead the ${enemy.bosstitle} of the ${enemy.name}. "What did the children ever do for me?`,`That I should mind their welfare?`],
        [`Why are you doing this? What is there to gain?" you ask the ${enemy.bosstitle} of the ${enemy.name}. "You don't always need a plan,`,`Sometimes you just need to breathe, trust, let go, and see what happens..`],
        [`You've come to the wrong place, ${defineAddressing(enemy)},`,`You will not leave here alive.`],
        [`I had heard you were sticking your nose in my business,`,`Fortunately, your efforts have been wasted.`],
        [`I was counting on you to come to try your pitiful mission, but I have news for you,`,`None of you will leave this place alive!`],
        [`I must possess all,`,`Or I possess nothing!`],
        [`I ache to smash you out of existence!`,`To drive your cursed face from my memories forever!`],
        [`You can't win," you tell ${enemy.boss} wearily. "I've already won this this the old-fashioned way, the tried and true way:`,`I cheated!`],
        [`I am the Alpha and the Omega. Death and Rebirth,`,`And, as you die, so will I be reborn!`],
        [`Welcome to your doom, ${defineAddressing(enemy)},`,`I would have waited an eternity for this!`],
        [`This is how it begins!`,`The ${enemy.name} triumphant at last!`],
        [`How I loathe heroes!`,`Always getting in the way and acting so.. heroic!`],
        [`I cannot be defeated,`,`I must break you.`],
        [`I fight to win, for me!`,`For me!`],
        [`I defeat all,`,`Until the end.`],
        [`To survive a war,`,`You must become war.`],
        [`You lived for something!`,`But you will die for nothing.`],
        [`Game over, Gladiator, game over!`,`What are you going to do now?`],
        [`Gladiator! You know, I.. I expected more from you,`,`I thought you'd be tougher than this.`],
        [`Wait!" you shout.<br><br>"Wait? Are you kidding me? Did you just say "Wait"? Global Gladiators have come this far, and all I get is "Wait"?`,`You know what? I expected more from you. I mean, wait for what? Wait for me to change my mind?`],
        [`Any last words?", ${enemy.boss} asks. You deprive ${genderPronoun(enemy.sex,"object")} of an answer. "Any?`,`Thought as much.`],
        [`Have you any last words?`,`Before I dispatch you?`],
        [`You're quite the piece of work, ${defineAddressing(enemy)},`,`But I am superior!`],
        [`You think you can take on me?`,`You need an army to take on me! You hear?! Who do you think you're dealing with?!`],
        [`When you have a chance to kill someone,`,`Don't hesitate.`],
        [`I have something to ask:`,`Is is better to burn out, than to fade away?`],
        [`You've gotta ask yourself one question: Do I feel lucky?`,`Well, do you, ${defineAddressing(enemy)}?`],
        [`I feel no pity, or remorse, or fear,`,`And I absolutely will not stop - ever - until ${enemy.name} rules over everything!`],
        [`Did you believe I would let you on my trail by mistake?`,`Now face your death!`],
        [`Death smiles at us all,`,`All you can do is to smile back.`],
        [`It's been a funny sort of day,`,`Isn't it?`],
        [`${defineAddressing(enemy)},`,`I thought you were made of sterner stuff.`],
        [`Why, ${defineAddressing(enemy)}? Why do you do it? Why keep fighting?`,`Do you believe you're fighting for something? Can you tell me what it is? Do you even know?`],
        [`You must be able to see it. You must know it by now,`,`You can't win. It's pointless to keep fighting. Why do you persist?`],
        [`I won't get away with this?`,`I already have!`],
        [`You have no idea how much I've wanted to do this.`,`You have no idea.`],
        [`Soon, you'll die for your efforts,`,`Well, I'm dying for some lunch.`],
        [`Gladiators are always rushing to their death,`,`That's it, just rushing to your death.`],
        [`You've dug your own grave,`,`You're dead!`],
        [`I am your death.`,`Are you prepared?`],
        [`Death is the greatest kick.`,`That's why I saved it for last!`],
        [`I've never been beat. A lot of Gladiators have have tried.`,`Seems to me there's more Gladiators lately than ever.`],
        [`Frankly, I find the idea of Gladiator that lives..`,`Offensive.`]
        ]

        return randFrom(gloating)
}

function laconicStatement() {
    laconicstatements = [
        "This could well be, but you have to try",
        "You agree to disagree",
        "You don't know if this a fight you can win, but you have to try",
        "While there is life, there is hope, you remind yourself",
        "You've heard that line before",
        "This isn't going to be easy",
        "You shrug. It doesn't need to be this way, but it always is",
        "You have a feeling the boss might be right.",
        "Not this time, that's for sure",
        "That's not a completely bad point, you think to yourself"
    ]

    return randFrom(laconicstatements)
}


</script>

</body>
</html> 

